const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-E49GQuAK.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/gzip-CF-9a_hd.js","assets/browser-B-ZyVB-j.js","assets/lz4-BIGKWw27.js","assets/zlib-CBiqHlio.js","assets/zstd-IvP746pw.js"])))=>i.map(i=>d[i]);
var Cr=Object.defineProperty;var di=t=>{throw TypeError(t)};var Tr=(t,e,n)=>e in t?Cr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ee=(t,e,n)=>Tr(t,typeof e!="symbol"?e+"":e,n),An=(t,e,n)=>e.has(t)||di("Cannot "+n);var K=(t,e,n)=>(An(t,e,"read from private field"),n?n.call(t):e.get(t)),Ae=(t,e,n)=>e.has(t)?di("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),be=(t,e,n,i)=>(An(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Sn=(t,e,n)=>(An(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Te(){}function zr(t,e){for(const n in e)t[n]=e[n];return t}function ar(t){return t()}function _i(){return Object.create(null)}function tt(t){t.forEach(ar)}function jn(t){return typeof t=="function"}function nt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let nn;function gi(t,e){return t===e?!0:(nn||(nn=document.createElement("a")),nn.href=e,t===nn.href)}function Rr(t){return Object.keys(t).length===0}function Or(t,...e){if(t==null){for(const i of e)i(void 0);return Te}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function on(t){let e;return Or(t,n=>e=n)(),e}function Tn(t,e,n,i){if(t){const r=ur(t,e,n,i);return t[0](r)}}function ur(t,e,n,i){return t[1]&&i?zr(n.ctx.slice(),t[1](i(e))):n.ctx}function zn(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function Rn(t,e,n,i,r,s){if(r){const o=ur(e,n,i,s);t.p(o,r)}}function On(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function d(t,e){t.appendChild(e)}function pe(t,e,n){t.insertBefore(e,n||null)}function _e(t){t.parentNode&&t.parentNode.removeChild(t)}function cn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function A(t){return document.createElement(t)}function W(t){return document.createTextNode(t)}function Y(){return W(" ")}function cr(){return W("")}function we(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function w(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Lr(t){return Array.from(t.childNodes)}function Se(t,e){e=""+e,t.data!==e&&(t.data=e)}function Oe(t,e){t.value=e??""}function ce(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function it(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function rn(t){const e=t.querySelector(":checked");return e&&e.__value}function Tt(t,e,n){t.classList.toggle(e,!!n)}function Fr(t,e,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:i})}let Ut;function Pt(t){Ut=t}function qn(){if(!Ut)throw new Error("Function called outside component initialization");return Ut}function xn(t){qn().$$.on_mount.push(t)}function Vn(t){qn().$$.on_destroy.push(t)}function Mr(){const t=qn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Fr(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}const Ct=[],Bt=[];let zt=[];const mi=[],Dr=Promise.resolve();let Ln=!1;function Nr(){Ln||(Ln=!0,Dr.then(Me))}function et(t){zt.push(t)}const In=new Set;let At=0;function Me(){if(At!==0)return;const t=Ut;do{try{for(;At<Ct.length;){const e=Ct[At];At++,Pt(e),Pr(e.$$)}}catch(e){throw Ct.length=0,At=0,e}for(Pt(null),Ct.length=0,At=0;Bt.length;)Bt.pop()();for(let e=0;e<zt.length;e+=1){const n=zt[e];In.has(n)||(In.add(n),n())}zt.length=0}while(Ct.length);for(;mi.length;)mi.pop()();Ln=!1,In.clear(),Pt(t)}function Pr(t){if(t.fragment!==null){t.update(),tt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(et)}}function Ur(t){const e=[],n=[];zt.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),zt=e}const ln=new Set;let pt;function Wn(){pt={r:0,c:[],p:pt}}function Hn(){pt.r||tt(pt.c),pt=pt.p}function he(t,e){t&&t.i&&(ln.delete(t),t.i(e))}function ve(t,e,n,i){if(t&&t.o){if(ln.has(t))return;ln.add(t),pt.c.push(()=>{ln.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}function Je(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Br(t,e){t.d(1),e.delete(t.key)}function jr(t,e){ve(t,1,1,()=>{e.delete(t.key)})}function fr(t,e,n,i,r,s,o,l,a,h,f,_){let g=t.length,b=s.length,m=g;const z={};for(;m--;)z[t[m].key]=m;const N=[],O=new Map,x=new Map,B=[];for(m=b;m--;){const S=_(r,s,m),u=n(S);let c=o.get(u);c?B.push(()=>c.p(S,e)):(c=h(u,S),c.c()),O.set(u,N[m]=c),u in z&&x.set(u,Math.abs(m-z[u]))}const H=new Set,q=new Set;function Z(S){he(S,1),S.m(l,f),o.set(S.key,S),f=S.first,b--}for(;g&&b;){const S=N[b-1],u=t[g-1],c=S.key,p=u.key;S===u?(f=S.first,g--,b--):O.has(p)?!o.has(c)||H.has(c)?Z(S):q.has(p)?g--:x.get(c)>x.get(p)?(q.add(c),Z(S)):(H.add(p),g--):(a(u,o),g--)}for(;g--;){const S=t[g];O.has(S.key)||a(S,o)}for(;b;)Z(N[b-1]);return tt(B),N}function Ke(t){t&&t.c()}function xe(t,e,n){const{fragment:i,after_update:r}=t.$$;i&&i.m(e,n),et(()=>{const s=t.$$.on_mount.map(ar).filter(jn);t.$$.on_destroy?t.$$.on_destroy.push(...s):tt(s),t.$$.on_mount=[]}),r.forEach(et)}function Ve(t,e){const n=t.$$;n.fragment!==null&&(Ur(n.after_update),tt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function qr(t,e){t.$$.dirty[0]===-1&&(Ct.push(t),Nr(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ot(t,e,n,i,r,s,o=null,l=[-1]){const a=Ut;Pt(t);const h=t.$$={fragment:null,ctx:[],props:s,update:Te,not_equal:r,bound:_i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:_i(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(h.root);let f=!1;if(h.ctx=n?n(t,e.props||{},(_,g,...b)=>{const m=b.length?b[0]:g;return h.ctx&&r(h.ctx[_],h.ctx[_]=m)&&(!h.skip_bound&&h.bound[_]&&h.bound[_](m),f&&qr(t,_)),g}):[],h.update(),f=!0,tt(h.before_update),h.fragment=i?i(h.ctx):!1,e.target){if(e.hydrate){const _=Lr(e.target);h.fragment&&h.fragment.l(_),_.forEach(_e)}else h.fragment&&h.fragment.c();e.intro&&he(t.$$.fragment),xe(t,e.target,e.anchor),Me()}Pt(a)}class lt{constructor(){ee(this,"$$");ee(this,"$$set")}$destroy(){Ve(this,1),this.$destroy=Te}$on(e,n){if(!jn(n))return Te;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!Rr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const xr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(xr);const St=[];function hr(t,e=Te){let n;const i=new Set;function r(l){if(nt(t,l)&&(t=l,n)){const a=!St.length;for(const h of i)h[1](),St.push(h,t);if(a){for(let h=0;h<St.length;h+=2)St[h][0](St[h+1]);St.length=0}}}function s(l){r(l(t))}function o(l,a=Te){const h=[l,a];return i.add(h),i.size===1&&(n=e(r,s)||Te),l(t),()=>{i.delete(h),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}var Vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dr={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(n,i){t.exports=i()})(Vr,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},r=!i.document&&!!i.postMessage,s=i.IS_PAPA_WORKER||!1,o={},l=0,a={parse:function(u,c){var p=(c=c||{}).dynamicTyping||!1;if(S(p)&&(c.dynamicTypingFunction=p,p={}),c.dynamicTyping=p,c.transform=!!S(c.transform)&&c.transform,c.worker&&a.WORKERS_SUPPORTED){var I=function(){if(!a.WORKERS_SUPPORTED)return!1;var L=(M=i.URL||i.webkitURL||null,k=n.toString(),a.BLOB_URL||(a.BLOB_URL=M.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",k,")();"],{type:"text/javascript"})))),F=new i.Worker(L),M,k;return F.onmessage=x,F.id=l++,o[F.id]=F}();return I.userStep=c.step,I.userChunk=c.chunk,I.userComplete=c.complete,I.userError=c.error,c.step=S(c.step),c.chunk=S(c.chunk),c.complete=S(c.complete),c.error=S(c.error),delete c.worker,void I.postMessage({input:u,config:c,workerId:I.id})}var T=null;return a.NODE_STREAM_INPUT,typeof u=="string"?(u=function(L){return L.charCodeAt(0)===65279?L.slice(1):L}(u),T=c.download?new _(c):new b(c)):u.readable===!0&&S(u.read)&&S(u.on)?T=new m(c):(i.File&&u instanceof File||u instanceof Object)&&(T=new g(c)),T.stream(u)},unparse:function(u,c){var p=!1,I=!0,T=",",L=`\r
`,F='"',M=F+F,k=!1,y=null,V=!1;(function(){if(typeof c=="object"){if(typeof c.delimiter!="string"||a.BAD_DELIMITERS.filter(function(R){return c.delimiter.indexOf(R)!==-1}).length||(T=c.delimiter),(typeof c.quotes=="boolean"||typeof c.quotes=="function"||Array.isArray(c.quotes))&&(p=c.quotes),typeof c.skipEmptyLines!="boolean"&&typeof c.skipEmptyLines!="string"||(k=c.skipEmptyLines),typeof c.newline=="string"&&(L=c.newline),typeof c.quoteChar=="string"&&(F=c.quoteChar),typeof c.header=="boolean"&&(I=c.header),Array.isArray(c.columns)){if(c.columns.length===0)throw new Error("Option columns is empty");y=c.columns}c.escapeChar!==void 0&&(M=c.escapeChar+F),(typeof c.escapeFormulae=="boolean"||c.escapeFormulae instanceof RegExp)&&(V=c.escapeFormulae instanceof RegExp?c.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var E=new RegExp(N(F),"g");if(typeof u=="string"&&(u=JSON.parse(u)),Array.isArray(u)){if(!u.length||Array.isArray(u[0]))return ae(null,u,k);if(typeof u[0]=="object")return ae(y||Object.keys(u[0]),u,k)}else if(typeof u=="object")return typeof u.data=="string"&&(u.data=JSON.parse(u.data)),Array.isArray(u.data)&&(u.fields||(u.fields=u.meta&&u.meta.fields||y),u.fields||(u.fields=Array.isArray(u.data[0])?u.fields:typeof u.data[0]=="object"?Object.keys(u.data[0]):[]),Array.isArray(u.data[0])||typeof u.data[0]=="object"||(u.data=[u.data])),ae(u.fields||[],u.data||[],k);throw new Error("Unable to serialize unrecognized input");function ae(R,ie,C){var U="";typeof R=="string"&&(R=JSON.parse(R)),typeof ie=="string"&&(ie=JSON.parse(ie));var te=Array.isArray(R)&&0<R.length,$=!Array.isArray(ie[0]);if(te&&I){for(var G=0;G<R.length;G++)0<G&&(U+=T),U+=X(R[G],G);0<ie.length&&(U+=L)}for(var D=0;D<ie.length;D++){var j=te?R.length:ie[D].length,ne=!1,de=te?Object.keys(ie[D]).length===0:ie[D].length===0;if(C&&!te&&(ne=C==="greedy"?ie[D].join("").trim()==="":ie[D].length===1&&ie[D][0].length===0),C==="greedy"&&te){for(var re=[],ke=0;ke<j;ke++){var ue=$?R[ke]:ke;re.push(ie[D][ue])}ne=re.join("").trim()===""}if(!ne){for(var Q=0;Q<j;Q++){0<Q&&!de&&(U+=T);var Ne=te&&$?R[Q]:Q;U+=X(ie[D][Ne],Q)}D<ie.length-1&&(!C||0<j&&!de)&&(U+=L)}}return U}function X(R,ie){if(R==null)return"";if(R.constructor===Date)return JSON.stringify(R).slice(1,25);var C=!1;V&&typeof R=="string"&&V.test(R)&&(R="'"+R,C=!0);var U=R.toString().replace(E,M);return(C=C||p===!0||typeof p=="function"&&p(R,ie)||Array.isArray(p)&&p[ie]||function(te,$){for(var G=0;G<$.length;G++)if(-1<te.indexOf($[G]))return!0;return!1}(U,a.BAD_DELIMITERS)||-1<U.indexOf(T)||U.charAt(0)===" "||U.charAt(U.length-1)===" ")?F+U+F:U}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!i.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=O,a.ParserHandle=z,a.NetworkStreamer=_,a.FileStreamer=g,a.StringStreamer=b,a.ReadableStreamStreamer=m,i.jQuery){var h=i.jQuery;h.fn.parse=function(u){var c=u.config||{},p=[];return this.each(function(L){if(!(h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var F=0;F<this.files.length;F++)p.push({file:this.files[F],inputElem:this,instanceConfig:h.extend({},c)})}),I(),this;function I(){if(p.length!==0){var L,F,M,k,y=p[0];if(S(u.before)){var V=u.before(y.file,y.inputElem);if(typeof V=="object"){if(V.action==="abort")return L="AbortError",F=y.file,M=y.inputElem,k=V.reason,void(S(u.error)&&u.error({name:L},F,M,k));if(V.action==="skip")return void T();typeof V.config=="object"&&(y.instanceConfig=h.extend(y.instanceConfig,V.config))}else if(V==="skip")return void T()}var E=y.instanceConfig.complete;y.instanceConfig.complete=function(ae){S(E)&&E(ae,y.file,y.inputElem),T()},a.parse(y.file,y.instanceConfig)}else S(u.complete)&&u.complete()}function T(){p.splice(0,1),I()}}}function f(u){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(c){var p=q(c);p.chunkSize=parseInt(p.chunkSize),c.step||c.chunk||(p.chunkSize=null),this._handle=new z(p),(this._handle.streamer=this)._config=p}).call(this,u),this.parseChunk=function(c,p){if(this.isFirstChunk&&S(this._config.beforeFirstChunk)){var I=this._config.beforeFirstChunk(c);I!==void 0&&(c=I)}this.isFirstChunk=!1,this._halted=!1;var T=this._partialLine+c;this._partialLine="";var L=this._handle.parse(T,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var F=L.meta.cursor;this._finished||(this._partialLine=T.substring(F-this._baseIndex),this._baseIndex=F),L&&L.data&&(this._rowCount+=L.data.length);var M=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)i.postMessage({results:L,workerId:a.WORKER_ID,finished:M});else if(S(this._config.chunk)&&!p){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);L=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!M||!S(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),M||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(c){S(this._config.error)?this._config.error(c):s&&this._config.error&&i.postMessage({workerId:a.WORKER_ID,error:c,finished:!1})}}function _(u){var c;(u=u||{}).chunkSize||(u.chunkSize=a.RemoteChunkSize),f.call(this,u),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(p){this._input=p,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(c=new XMLHttpRequest,this._config.withCredentials&&(c.withCredentials=this._config.withCredentials),r||(c.onload=Z(this._chunkLoaded,this),c.onerror=Z(this._chunkError,this)),c.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var p=this._config.downloadRequestHeaders;for(var I in p)c.setRequestHeader(I,p[I])}if(this._config.chunkSize){var T=this._start+this._config.chunkSize-1;c.setRequestHeader("Range","bytes="+this._start+"-"+T)}try{c.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}r&&c.status===0&&this._chunkError()}},this._chunkLoaded=function(){c.readyState===4&&(c.status<200||400<=c.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:c.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(p){var I=p.getResponseHeader("Content-Range");return I===null?-1:parseInt(I.substring(I.lastIndexOf("/")+1))}(c),this.parseChunk(c.responseText)))},this._chunkError=function(p){var I=c.statusText||p;this._sendError(new Error(I))}}function g(u){var c,p;(u=u||{}).chunkSize||(u.chunkSize=a.LocalChunkSize),f.call(this,u);var I=typeof FileReader<"u";this.stream=function(T){this._input=T,p=T.slice||T.webkitSlice||T.mozSlice,I?((c=new FileReader).onload=Z(this._chunkLoaded,this),c.onerror=Z(this._chunkError,this)):c=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input;if(this._config.chunkSize){var L=Math.min(this._start+this._config.chunkSize,this._input.size);T=p.call(T,this._start,L)}var F=c.readAsText(T,this._config.encoding);I||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(c.error)}}function b(u){var c;f.call(this,u=u||{}),this.stream=function(p){return c=p,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var p,I=this._config.chunkSize;return I?(p=c.substring(0,I),c=c.substring(I)):(p=c,c=""),this._finished=!c,this.parseChunk(p)}}}function m(u){f.call(this,u=u||{});var c=[],p=!0,I=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){I&&c.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),c.length?this.parseChunk(c.shift()):p=!0},this._streamData=Z(function(T){try{c.push(typeof T=="string"?T:T.toString(this._config.encoding)),p&&(p=!1,this._checkIsFinished(),this.parseChunk(c.shift()))}catch(L){this._streamError(L)}},this),this._streamError=Z(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=Z(function(){this._streamCleanUp(),I=!0,this._streamData("")},this),this._streamCleanUp=Z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function z(u){var c,p,I,T=Math.pow(2,53),L=-T,F=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,M=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,k=this,y=0,V=0,E=!1,ae=!1,X=[],R={data:[],errors:[],meta:{}};if(S(u.step)){var ie=u.step;u.step=function(D){if(R=D,te())U();else{if(U(),R.data.length===0)return;y+=D.data.length,u.preview&&y>u.preview?p.abort():(R.data=R.data[0],ie(R,k))}}}function C(D){return u.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function U(){return R&&I&&(G("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),I=!1),u.skipEmptyLines&&(R.data=R.data.filter(function(D){return!C(D)})),te()&&function(){if(!R)return;function D(ne,de){S(u.transformHeader)&&(ne=u.transformHeader(ne,de)),X.push(ne)}if(Array.isArray(R.data[0])){for(var j=0;te()&&j<R.data.length;j++)R.data[j].forEach(D);R.data.splice(0,1)}else R.data.forEach(D)}(),function(){if(!R||!u.header&&!u.dynamicTyping&&!u.transform)return R;function D(ne,de){var re,ke=u.header?{}:[];for(re=0;re<ne.length;re++){var ue=re,Q=ne[re];u.header&&(ue=re>=X.length?"__parsed_extra":X[re]),u.transform&&(Q=u.transform(Q,ue)),Q=$(ue,Q),ue==="__parsed_extra"?(ke[ue]=ke[ue]||[],ke[ue].push(Q)):ke[ue]=Q}return u.header&&(re>X.length?G("FieldMismatch","TooManyFields","Too many fields: expected "+X.length+" fields but parsed "+re,V+de):re<X.length&&G("FieldMismatch","TooFewFields","Too few fields: expected "+X.length+" fields but parsed "+re,V+de)),ke}var j=1;return!R.data.length||Array.isArray(R.data[0])?(R.data=R.data.map(D),j=R.data.length):R.data=D(R.data,0),u.header&&R.meta&&(R.meta.fields=X),V+=j,R}()}function te(){return u.header&&X.length===0}function $(D,j){return ne=D,u.dynamicTypingFunction&&u.dynamicTyping[ne]===void 0&&(u.dynamicTyping[ne]=u.dynamicTypingFunction(ne)),(u.dynamicTyping[ne]||u.dynamicTyping)===!0?j==="true"||j==="TRUE"||j!=="false"&&j!=="FALSE"&&(function(de){if(F.test(de)){var re=parseFloat(de);if(L<re&&re<T)return!0}return!1}(j)?parseFloat(j):M.test(j)?new Date(j):j===""?null:j):j;var ne}function G(D,j,ne,de){var re={type:D,code:j,message:ne};de!==void 0&&(re.row=de),R.errors.push(re)}this.parse=function(D,j,ne){var de=u.quoteChar||'"';if(u.newline||(u.newline=function(ue,Q){ue=ue.substring(0,1048576);var Ne=new RegExp(N(Q)+"([^]*?)"+N(Q),"gm"),Le=(ue=ue.replace(Ne,"")).split("\r"),Ie=ue.split(`
`),ge=1<Ie.length&&Ie[0].length<Le[0].length;if(Le.length===1||ge)return`
`;for(var Ee=0,se=0;se<Le.length;se++)Le[se][0]===`
`&&Ee++;return Ee>=Le.length/2?`\r
`:"\r"}(D,de)),I=!1,u.delimiter)S(u.delimiter)&&(u.delimiter=u.delimiter(D),R.meta.delimiter=u.delimiter);else{var re=function(ue,Q,Ne,Le,Ie){var ge,Ee,se,fe;Ie=Ie||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var Qe=0;Qe<Ie.length;Qe++){var J=Ie[Qe],Xe=0,We=0,He=0;se=void 0;for(var Ce=new O({comments:Le,delimiter:J,newline:Q,preview:10}).parse(ue),Ge=0;Ge<Ce.data.length;Ge++)if(Ne&&C(Ce.data[Ge]))He++;else{var Ye=Ce.data[Ge].length;We+=Ye,se!==void 0?0<Ye&&(Xe+=Math.abs(Ye-se),se=Ye):se=Ye}0<Ce.data.length&&(We/=Ce.data.length-He),(Ee===void 0||Xe<=Ee)&&(fe===void 0||fe<We)&&1.99<We&&(Ee=Xe,ge=J,fe=We)}return{successful:!!(u.delimiter=ge),bestDelimiter:ge}}(D,u.newline,u.skipEmptyLines,u.comments,u.delimitersToGuess);re.successful?u.delimiter=re.bestDelimiter:(I=!0,u.delimiter=a.DefaultDelimiter),R.meta.delimiter=u.delimiter}var ke=q(u);return u.preview&&u.header&&ke.preview++,c=D,p=new O(ke),R=p.parse(c,j,ne),U(),E?{meta:{paused:!0}}:R||{meta:{paused:!1}}},this.paused=function(){return E},this.pause=function(){E=!0,p.abort(),c=S(u.chunk)?"":c.substring(p.getCharIndex())},this.resume=function(){k.streamer._halted?(E=!1,k.streamer.parseChunk(c,!0)):setTimeout(k.resume,3)},this.aborted=function(){return ae},this.abort=function(){ae=!0,p.abort(),R.meta.aborted=!0,S(u.complete)&&u.complete(R),c=""}}function N(u){return u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function O(u){var c,p=(u=u||{}).delimiter,I=u.newline,T=u.comments,L=u.step,F=u.preview,M=u.fastMode,k=c=u.quoteChar===void 0||u.quoteChar===null?'"':u.quoteChar;if(u.escapeChar!==void 0&&(k=u.escapeChar),(typeof p!="string"||-1<a.BAD_DELIMITERS.indexOf(p))&&(p=","),T===p)throw new Error("Comment character same as delimiter");T===!0?T="#":(typeof T!="string"||-1<a.BAD_DELIMITERS.indexOf(T))&&(T=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var y=0,V=!1;this.parse=function(E,ae,X){if(typeof E!="string")throw new Error("Input must be a string");var R=E.length,ie=p.length,C=I.length,U=T.length,te=S(L),$=[],G=[],D=[],j=y=0;if(!E)return ze();if(u.header&&!ae){var ne=E.split(I)[0].split(p),de=[],re={},ke=!1;for(var ue in ne){var Q=ne[ue];S(u.transformHeader)&&(Q=u.transformHeader(Q,ue));var Ne=Q,Le=re[Q]||0;for(0<Le&&(ke=!0,Ne=Q+"_"+Le),re[Q]=Le+1;de.includes(Ne);)Ne=Ne+"_"+Le;de.push(Ne)}if(ke){var Ie=E.split(I);Ie[0]=de.join(p),E=Ie.join(I)}}if(M||M!==!1&&E.indexOf(c)===-1){for(var ge=E.split(I),Ee=0;Ee<ge.length;Ee++){if(D=ge[Ee],y+=D.length,Ee!==ge.length-1)y+=I.length;else if(X)return ze();if(!T||D.substring(0,U)!==T){if(te){if($=[],He(D.split(p)),at(),V)return ze()}else He(D.split(p));if(F&&F<=Ee)return $=$.slice(0,F),ze(!0)}}return ze()}for(var se=E.indexOf(p,y),fe=E.indexOf(I,y),Qe=new RegExp(N(k)+N(c),"g"),J=E.indexOf(c,y);;)if(E[y]!==c)if(T&&D.length===0&&E.substring(y,y+U)===T){if(fe===-1)return ze();y=fe+C,fe=E.indexOf(I,y),se=E.indexOf(p,y)}else if(se!==-1&&(se<fe||fe===-1))D.push(E.substring(y,se)),y=se+ie,se=E.indexOf(p,y);else{if(fe===-1)break;if(D.push(E.substring(y,fe)),Ye(fe+C),te&&(at(),V))return ze();if(F&&$.length>=F)return ze(!0)}else for(J=y,y++;;){if((J=E.indexOf(c,J+1))===-1)return X||G.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:$.length,index:y}),Ge();if(J===R-1)return Ge(E.substring(y,J).replace(Qe,c));if(c!==k||E[J+1]!==k){if(c===k||J===0||E[J-1]!==k){se!==-1&&se<J+1&&(se=E.indexOf(p,J+1)),fe!==-1&&fe<J+1&&(fe=E.indexOf(I,J+1));var Xe=Ce(fe===-1?se:Math.min(se,fe));if(E.substr(J+1+Xe,ie)===p){D.push(E.substring(y,J).replace(Qe,c)),E[y=J+1+Xe+ie]!==c&&(J=E.indexOf(c,y)),se=E.indexOf(p,y),fe=E.indexOf(I,y);break}var We=Ce(fe);if(E.substring(J+1+We,J+1+We+C)===I){if(D.push(E.substring(y,J).replace(Qe,c)),Ye(J+1+We+C),se=E.indexOf(p,y),J=E.indexOf(c,y),te&&(at(),V))return ze();if(F&&$.length>=F)return ze(!0);break}G.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:$.length,index:y}),J++}}else J++}return Ge();function He(le){$.push(le),j=y}function Ce(le){var Ze=0;if(le!==-1){var wt=E.substring(J+1,le);wt&&wt.trim()===""&&(Ze=wt.length)}return Ze}function Ge(le){return X||(le===void 0&&(le=E.substring(y)),D.push(le),y=R,He(D),te&&at()),ze()}function Ye(le){y=le,He(D),D=[],fe=E.indexOf(I,y)}function ze(le){return{data:$,errors:G,meta:{delimiter:p,linebreak:I,aborted:V,truncated:!!le,cursor:j+(ae||0)}}}function at(){L(ze()),$=[],G=[]}},this.abort=function(){V=!0},this.getCharIndex=function(){return y}}function x(u){var c=u.data,p=o[c.workerId],I=!1;if(c.error)p.userError(c.error,c.file);else if(c.results&&c.results.data){var T={abort:function(){I=!0,B(c.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:H,resume:H};if(S(p.userStep)){for(var L=0;L<c.results.data.length&&(p.userStep({data:c.results.data[L],errors:c.results.errors,meta:c.results.meta},T),!I);L++);delete c.results}else S(p.userChunk)&&(p.userChunk(c.results,T,c.file),delete c.results)}c.finished&&!I&&B(c.workerId,c.results)}function B(u,c){var p=o[u];S(p.userComplete)&&p.userComplete(c),p.terminate(),delete o[u]}function H(){throw new Error("Not implemented.")}function q(u){if(typeof u!="object"||u===null)return u;var c=Array.isArray(u)?[]:{};for(var p in u)c[p]=q(u[p]);return c}function Z(u,c){return function(){u.apply(c,arguments)}}function S(u){return typeof u=="function"}return s&&(i.onmessage=function(u){var c=u.data;if(a.WORKER_ID===void 0&&c&&(a.WORKER_ID=c.workerId),typeof c.input=="string")i.postMessage({workerId:a.WORKER_ID,results:a.parse(c.input,c.config),finished:!0});else if(i.File&&c.input instanceof File||c.input instanceof Object){var p=a.parse(c.input,c.config);p&&i.postMessage({workerId:a.WORKER_ID,results:p,finished:!0})}}),(_.prototype=Object.create(f.prototype)).constructor=_,(g.prototype=Object.create(f.prototype)).constructor=g,(b.prototype=Object.create(b.prototype)).constructor=b,(m.prototype=Object.create(f.prototype)).constructor=m,a})})(dr);var Hr=dr.exports;const Kr=Wr(Hr),Jr="https://will-moore.github.io/ome2024-ngff-challenge/idr-mark.svg",Gr="https://will-moore.github.io/ome2024-ngff-challenge/nfdi4bioimage.png",Yr="https://raw.githubusercontent.com/will-moore/ome2024-ngff-challenge/hierarchy_browser/samples/ngff_samples.csv";let Qr={IDR:"https://idr.openmicroscopy.org",Webknossos:"https://scalableminds.com",JAX:"http://jax.org","BioImage Archive":"https://www.ebi.ac.uk",Crick:"https://www.crick.ac.uk/","University of Muenster":"https://nfdi4bioimage.de/",Göttingen:"https://nfdi4bioimage.de/",Jülich:"https://nfdi4bioimage.de/",NFDI4BIOIMAGE:"https://nfdi4bioimage.de/"};function pi(t){if(t==="IDR")return Jr;let e=Qr[t];return e?e==="https://nfdi4bioimage.de/"?Gr:`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${e}&size=24`:null}function _r(t,e,n={}){Kr.parse(t,{header:!1,download:!0,skipEmptyLines:"greedy",complete:function(i){let r=["url"],s=i.data[0];s.length>1&&(r=s,i.data.shift());let o=i.data.map(f=>{let _={...n};for(let g=0;g<r.length;g++)_[r[g]]=f[g];return _}),l=o.filter(f=>{var _;return!((_=f.url)!=null&&_.endsWith(".csv"))}),a={};l.forEach(f=>{if(a[f.url]){console.warn("Removing duplicate URL:",f.url);return}a[f.url]=f}),l=Object.values(a);let h=o.filter(f=>{var _;return(_=f.url)==null?void 0:_.includes(".csv")});e.addCsv(t,h,l.length),e.addRows(l),h.forEach(f=>{let _=f.url;f.csv=_,_r(_,e,f)})}})}async function gr(t){return await fetch(t).then(e=>e.json())}function yi(t){return Math.floor(Math.random()*t)}function fn(t){if(!t)return"";const e=2;return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(e)+" KB":t<1024*1024*1024?(t/(1024*1024)).toFixed(e)+" MB":t<1024*1024*1024*1024?(t/(1024*1024*1024)).toFixed(e)+" GB":t<1024*1024*1024*1024*1024?(t/(1024*1024*1024*1024)).toFixed(e)+" TB":(t/(1024*1024*1024*1024*1024)).toFixed(e)+" PB"}function Zr(t,e){return Array.from({length:e-t},(n,i)=>i+t)}function Xr(t,e,n){const i=t[0].shape,r=i[0],s=i[1],o=r*s;e||(e=t.map(mr));const l=new Uint8ClampedArray(4*r*s).fill(0);let a=0;for(let h=0;h<o;h++){for(let f=0;f<t.length;f++){let _=n[f],g=t[f].data,b=e[f],z=(g[h]-b[0])/(b[1]-b[0]);for(let N=0;N<3;N++){let O=z*_[N]<<0;l[a*4+N]=Math.max(l[a*4+N],O)}}l[a*4+3]=255,a+=1}return l}function mr(t){const e=t.data;let n=0,i=1/0,r=t.data.length;for(let s=0;s<r;s++){let o=e[s];n=Math.max(n,o),i=Math.min(i,o)}return[i,n]}const an=4,st={cyan:"#00FFFF",yellow:"#FFFF00",magenta:"#FF00FF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",white:"#FFFFFF"},$r=[st.magenta,st.green],es=[st.red,st.green,st.blue],bi=Object.values(st).slice(0,-2);function ts(t){let e;return t<=an?e=Array(t).fill(!0):e=[...Array(an).fill(!0),...Array(t-an).fill(!1)],e}function ns(t,e){let n=[];if(t==1)n=[st.white];else if(t==2)n=$r;else if(t===3)n=es;else if(t<=an)n=bi.slice(0,t);else{n=Array(t).fill(st.white);const i=e.flatMap((r,s)=>r?s:[]);for(const[r,s]of i.entries())n[s]=bi[r]}return n.map(pr)}function pr(t){t.startsWith("#")&&(t=t.slice(1));const e=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),i=parseInt(t.slice(4,6),16);return[e,n,i]}class yr{constructor(){this.store=hr({})}async lookupOntologyTerm(e){let n=e.replace("NCBI:txid","");return(await gr(`https://rest.ensembl.org/taxonomy/id/${n}?content-type=application/json`)).name||e}addTerms(e){let n=on(this.store);[...new Set(e)].forEach(r=>{r&&(n[r]||(n[r]="Loading...",setTimeout(()=>{this.lookupOntologyTerm(r).then(s=>{this.addEntry(r,s)})},Math.random()*5e3)))})}addEntry(e,n){this.store.update(i=>(i[e]=n,i))}subscribe(e){return this.store.subscribe(e)}}class is extends yr{constructor(){super()}async lookupOntologyTerm(e){const n=e.replace("obo:","");return(await gr(`https://www.ebi.ac.uk/ols4/api/ontologies/fbbi/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252F${n}`)).label||e}}const br=new yr,vr=new is,vi=5;async function hn(t,e){var r;let n=await fetch(`${t}/zarr.json`,{signal:e}).then(s=>{if(s.status===404)throw new Error(`${t}/zarr.json not found`);return s.json()}).catch(s=>[void 0,t]);const i=(r=n==null?void 0:n.attributes)==null?void 0:r.ome;if(!i)return[void 0,t];if(i.multiscales)return[i,t];if(i.plate){let s=i.plate.wells[0],o=`${t}/${s.path}/0`,[l,a]=await hn(o);return[l,a,i.plate]}else if(i["bioformats2raw.layout"]){let s=`${t}/0`;return await hn(s)}}class rs{constructor(e="rating",n=!1){this.store=hr([]),this.sortColumn=e,this.sortAscending=n,this.csvFiles=[]}getCsvSourceList(e){let n;if(!e)n=this.csvFiles[0];else for(let r of this.csvFiles){if(r.source===e){n=r;break}for(let s of r.child_csv){if(s.source===e){n=s;break}for(let o of s.child_csv)if(o.source===e){n=o;break}}}return n?n.child_csv.map(r=>{let s=r.image_count||0;for(let o of r.child_csv)s+=o.image_count||0;return{...r,total_count:s}}):[]}addCsv(e,n,i){n=n.map(s=>({...s,child_csv:[]}));let r;for(let s of this.csvFiles){if(s.url===e){r=s;break}for(let o of s.child_csv){if(o.url===e){r=o;break}for(let l of o.child_csv)if(l.url===e){r=l;break}}}r?(r.image_count=i,r.child_csv=n):(r={url:e,image_count:i,child_csv:n},this.csvFiles.push(r))}addRows(e){e=e.map(r=>{if(r.written&&(r.written=parseFloat(r.written)),r.shape){let s=r.shape.split(",").map(l=>parseInt(l)),o;r.dimension_names?o=r.dimension_names.split(","):s.length==5&&(o=["t","c","z","y","x"]),o&&o.length==s.length&&o.forEach((l,a)=>r["size_"+l]=s[a]),r.dim_count=s.reduce((l,a)=>l+(a>1?1:0),0)}return r.rating=Math.random()*4,r}),e.length>1&&(e[yi(e.length)].rating=10+Math.random()*5,e[yi(e.length)].rating=5+Math.random()*5),console.log("Adding rows",e),this.store.update(r=>(r.push(...e),r.sort((s,o)=>this.compareRows(s,o,!0)),r));let n=e.map(r=>r.organismId);console.log("organismIds",n),br.addTerms(n);let i=e.map(r=>r.fbbiId);console.log("fbbiIds",i),vr.addTerms(i)}populateRow(e,n){this.store.update(i=>(i=i.map(r=>(r.url===e&&(r={...r,...n}),r)),i))}async loadNgffMetadata(e){var g;const[n,i,r]=await hn(e);let s=[],o=0,l=0,a=!1,h=!0,f={multiscales:n},_=i;if(r&&(o=r.wells.length,l=r.field_count||1),n){const b=(g=n[0])==null?void 0:g.datasets[0],m=b==null?void 0:b.path;if(m){const z=await fetch(`${i}/${m}/zarr.json`).then(N=>N.json()).catch(N=>{console.log(`----> Failed to parse ${i}/${m}/zarr.json`,N)});s=z==null?void 0:z.shape}}else console.log("No multiscales found"),a=!0,s=[0];this.populateRow(e,{image_attrs:f,image_url:_,shape:s,well_count:o,field_count:l,load_failed:a,loaded:h})}async loadRocrateJsonAllRows(){let e=on(this.store);for(let n=0;n<e.length;n=n+vi){let i=Zr(n,Math.min(n+vi,e.length)).map(r=>this.loadRocrateJson(e[r].url));await Promise.all(i)}}compareRows(e,n,i=!1){let r=e[this.sortColumn],s=n[this.sortColumn];if(i)return r===void 0&&(r=0),s===void 0&&(s=0),r<s?this.sortAscending?-1:1:r>s?this.sortAscending?1:-1:0;r===void 0&&(r=""),s===void 0&&(s="");let o=0;return i?o=r-s:o=r.localeCompare(s),this.sortAscending?o:-o}sortTable(e,n=!0){this.sortColumn=e,this.sortAscending=n;let i=this.isColumnNumeric(e);this.store.update(r=>(r.sort((s,o)=>this.compareRows(s,o,i)),r))}isColumnNumeric(e){let n=on(this.store);for(let i of n){let r=i[e];if(r!==void 0&&r!=="")return!isNaN(r)}}emptyTable(){this.store.set([])}subscribe(e){return this.store.subscribe(e)}getRows(){return on(this.store)}}const De=new rs;function ss(t){let e,n,i,r,s,o,l,a;return{c(){e=A("button"),n=W(t[1]),i=Y(),r=A("span"),r.textContent="^",s=Y(),o=A("span"),o.textContent="^",w(r,"class","acc svelte-v17gm5"),Tt(r,"strong",t[3]==t[0]&&t[4]),w(o,"class","dec svelte-v17gm5"),Tt(o,"strong",t[3]==t[0]&&!t[4]),w(e,"class","svelte-v17gm5")},m(h,f){pe(h,e,f),d(e,n),d(e,i),d(e,r),d(e,s),d(e,o),l||(a=we(e,"click",t[5]),l=!0)},p(h,[f]){f&2&&Se(n,h[1]),f&25&&Tt(r,"strong",h[3]==h[0]&&h[4]),f&25&&Tt(o,"strong",h[3]==h[0]&&!h[4])},i:Te,o:Te,d(h){h&&_e(e),l=!1,a()}}}function os(t,e,n){let{col_name:i}=e,{col_label:r}=e,{handleSort:s}=e,{sortedBy:o}=e,{sortAscending:l}=e;const a=()=>s(i);return t.$$set=h=>{"col_name"in h&&n(0,i=h.col_name),"col_label"in h&&n(1,r=h.col_label),"handleSort"in h&&n(2,s=h.handleSort),"sortedBy"in h&&n(3,o=h.sortedBy),"sortAscending"in h&&n(4,l=h.sortAscending)},[i,r,s,o,l,a]}class It extends lt{constructor(e){super(),ot(this,e,os,ss,nt,{col_name:0,col_label:1,handleSort:2,sortedBy:3,sortAscending:4})}}const sn={AUTO:"auto",START:"start",CENTER:"center",END:"end"},$e={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Mt={OBSERVED:0,REQUESTED:1},ls={[$e.VERTICAL]:"top",[$e.HORIZONTAL]:"left"},wi={[$e.VERTICAL]:"scrollTop",[$e.HORIZONTAL]:"scrollLeft"};class as{constructor({itemSize:e,itemCount:n,estimatedItemSize:i}){this.itemSize=e,this.itemCount=n,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:n,estimatedItemSize:i}){n!=null&&(this.itemCount=n),i!=null&&(this.estimatedItemSize=i),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:n}=this;return typeof n=="function"?n(e):Array.isArray(n)?n[e]:n}computeTotalSizeAndPositionData(){let e=0;for(let n=0;n<this.itemCount;n++){const i=this.getSize(n),r=e;e+=i,this.itemSizeAndPositionData[n]={offset:r,size:i}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s==null||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:i,size:s},i+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=sn.START,containerSize:n,currentOffset:i,targetIndex:r}){if(n<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,l=o-n+s.size;let a;switch(e){case sn.END:a=l;break;case sn.CENTER:a=o-(n-s.size)/2;break;case sn.START:a=o;break;default:a=Math.max(l,Math.min(o,i))}const h=this.getTotalSize();return Math.max(0,Math.min(h-n,a))}getVisibleRange({containerSize:e=0,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const s=n+e;let o=this.findNearestItem(n);if(o===void 0)throw Error(`Invalid offset ${n} specified`);const l=this.getSizeAndPositionForIndex(o);n=l.offset+l.size;let a=o;for(;n<s&&a<this.itemCount-1;)a++,n+=this.getSizeAndPositionForIndex(a).size;return i&&(o=Math.max(0,o-i),a=Math.min(a+i,this.itemCount-1)),{start:o,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let r=0,s=0;for(;e<=n;){if(r=e+Math.floor((n-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===i)return r;s<i?e=r+1:s>i&&(n=r-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}const us=t=>({}),ki=t=>({});function Ei(t,e,n){const i=t.slice();return i[37]=e[n],i}const cs=t=>({style:t[0]&4,index:t[0]&4}),Ai=t=>({style:t[37].style,index:t[37].index}),fs=t=>({}),Si=t=>({});function Ii(t,e){let n,i;const r=e[21].item,s=Tn(r,e,e[20],Ai);return{key:t,first:null,c(){n=cr(),s&&s.c(),this.first=n},m(o,l){pe(o,n,l),s&&s.m(o,l),i=!0},p(o,l){e=o,s&&s.p&&(!i||l[0]&1048580)&&Rn(s,r,e,e[20],i?zn(r,e[20],l,cs):On(e[20]),Ai)},i(o){i||(he(s,o),i=!0)},o(o){ve(s,o),i=!1},d(o){o&&_e(n),s&&s.d(o)}}}function hs(t){let e,n,i,r=[],s=new Map,o,l;const a=t[21].header,h=Tn(a,t,t[20],Si);let f=Je(t[2]);const _=m=>m[0]?m[0](m[37].index):m[37].index;for(let m=0;m<f.length;m+=1){let z=Ei(t,f,m),N=_(z);s.set(N,r[m]=Ii(N,z))}const g=t[21].footer,b=Tn(g,t,t[20],ki);return{c(){e=A("div"),h&&h.c(),n=Y(),i=A("div");for(let m=0;m<r.length;m+=1)r[m].c();o=Y(),b&&b.c(),w(i,"class","virtual-list-inner svelte-dwpad5"),w(i,"style",t[4]),w(e,"class","virtual-list-wrapper svelte-dwpad5"),w(e,"style",t[3])},m(m,z){pe(m,e,z),h&&h.m(e,null),d(e,n),d(e,i);for(let N=0;N<r.length;N+=1)r[N]&&r[N].m(i,null);d(e,o),b&&b.m(e,null),t[22](e),l=!0},p(m,z){h&&h.p&&(!l||z[0]&1048576)&&Rn(h,a,m,m[20],l?zn(a,m[20],z,fs):On(m[20]),Si),z[0]&1048581&&(f=Je(m[2]),Wn(),r=fr(r,z,_,1,m,f,s,i,jr,Ii,null,Ei),Hn()),(!l||z[0]&16)&&w(i,"style",m[4]),b&&b.p&&(!l||z[0]&1048576)&&Rn(b,g,m,m[20],l?zn(g,m[20],z,us):On(m[20]),ki),(!l||z[0]&8)&&w(e,"style",m[3])},i(m){if(!l){he(h,m);for(let z=0;z<f.length;z+=1)he(r[z]);he(b,m),l=!0}},o(m){ve(h,m);for(let z=0;z<r.length;z+=1)ve(r[z]);ve(b,m),l=!1},d(m){m&&_e(e),h&&h.d(m);for(let z=0;z<r.length;z+=1)r[z].d();b&&b.d(m),t[22](null)}}}const ds=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get(){return t={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return t})();function _s(t,e,n){let{$$slots:i={},$$scope:r}=e,{height:s}=e,{width:o="100%"}=e,{itemCount:l}=e,{itemSize:a}=e,{estimatedItemSize:h=null}=e,{stickyIndices:f=null}=e,{getKey:_=null}=e,{scrollDirection:g=$e.VERTICAL}=e,{scrollOffset:b=null}=e,{scrollToIndex:m=null}=e,{scrollToAlignment:z=null}=e,{scrollToBehaviour:N="instant"}=e,{overscanCount:O=3}=e;const x=Mr(),B=new as({itemCount:l,itemSize:a,estimatedItemSize:X()});let H=!1,q,Z=[],S={offset:b||m!=null&&Z.length&&V(m)||0,scrollChangeReason:Mt.REQUESTED},u=S,c={scrollToIndex:m,scrollToAlignment:z,scrollOffset:b,itemCount:l,itemSize:a,estimatedItemSize:h},p={},I="",T="";M(),xn(()=>{n(18,H=!0),q.addEventListener("scroll",E,ds),b!=null?k(b):m!=null&&k(V(m))}),Vn(()=>{H&&q.removeEventListener("scroll",E)});function L(){if(!H)return;const C=c.scrollToIndex!==m||c.scrollToAlignment!==z,U=c.itemCount!==l||c.itemSize!==a||c.estimatedItemSize!==h;U&&(B.updateConfig({itemSize:a,itemCount:l,estimatedItemSize:X()}),y()),c.scrollOffset!==b?n(19,S={offset:b||0,scrollChangeReason:Mt.REQUESTED}):typeof m=="number"&&(C||U)&&n(19,S={offset:V(m,z,l),scrollChangeReason:Mt.REQUESTED}),c={scrollToIndex:m,scrollToAlignment:z,scrollOffset:b,itemCount:l,itemSize:a,estimatedItemSize:h}}function F(){if(!H)return;const{offset:C,scrollChangeReason:U}=S;(u.offset!==C||u.scrollChangeReason!==U)&&M(),u.offset!==C&&U===Mt.REQUESTED&&k(C),u=S}function M(){const{offset:C}=S,{start:U,stop:te}=B.getVisibleRange({containerSize:g===$e.VERTICAL?s:o,offset:C,overscanCount:O});let $=[];const G=B.getTotalSize();g===$e.VERTICAL?(n(3,I=`height:${s}${typeof s=="number"?"px":""};width:${o};`),n(4,T=`flex-direction:column;height:${G}px;`)):(n(3,I=`height:${s};width:${o}${typeof o=="number"?"px":""}`),n(4,T=`min-height:100%;width:${G}px;`));const D=f!=null&&f.length!==0;if(D)for(let j=0;j<f.length;j++){const ne=f[j];$.push({index:ne,style:R(ne,!0)})}if(U!==void 0&&te!==void 0){for(let j=U;j<=te;j++)D&&f.includes(j)||$.push({index:j,style:R(j,!1)});x("itemsUpdated",{start:U,end:te})}n(2,Z=$)}function k(C){"scroll"in q?q.scroll({[ls[g]]:C,behavior:N}):n(1,q[wi[g]]=C,q)}function y(C=0){p={},B.resetItem(C),M()}function V(C,U=z,te=l){return(C<0||C>=te)&&(C=0),B.getUpdatedOffsetForIndex({align:U,containerSize:g===$e.VERTICAL?s:o,currentOffset:S.offset||0,targetIndex:C})}function E(C){const U=ae();U<0||S.offset===U||C.target!==q||(n(19,S={offset:U,scrollChangeReason:Mt.OBSERVED}),x("afterScroll",{offset:U,event:C}))}function ae(){return q[wi[g]]}function X(){return h||typeof a=="number"&&a||50}function R(C,U){if(p[C])return p[C];const{size:te,offset:$}=B.getSizeAndPositionForIndex(C);let G;return g===$e.VERTICAL?(G=`left:0;width:100%;height:${te}px;`,U?G+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${$}px;margin-bottom:${-($+te)}px;`:G+=`position:absolute;top:${$}px;`):(G=`top:0;width:${te}px;`,U?G+=`position:sticky;z-index:1;left:0;margin-left:${$}px;margin-right:${-($+te)}px;`:G+=`position:absolute;height:100%;left:${$}px;`),p[C]=G}function ie(C){Bt[C?"unshift":"push"](()=>{q=C,n(1,q)})}return t.$$set=C=>{"height"in C&&n(5,s=C.height),"width"in C&&n(6,o=C.width),"itemCount"in C&&n(7,l=C.itemCount),"itemSize"in C&&n(8,a=C.itemSize),"estimatedItemSize"in C&&n(9,h=C.estimatedItemSize),"stickyIndices"in C&&n(10,f=C.stickyIndices),"getKey"in C&&n(0,_=C.getKey),"scrollDirection"in C&&n(11,g=C.scrollDirection),"scrollOffset"in C&&n(12,b=C.scrollOffset),"scrollToIndex"in C&&n(13,m=C.scrollToIndex),"scrollToAlignment"in C&&n(14,z=C.scrollToAlignment),"scrollToBehaviour"in C&&n(15,N=C.scrollToBehaviour),"overscanCount"in C&&n(16,O=C.overscanCount),"$$scope"in C&&n(20,r=C.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&29568&&L(),t.$$.dirty[0]&524288&&F(),t.$$.dirty[0]&263264&&H&&y(0)},[_,q,Z,I,T,s,o,l,a,h,f,g,b,m,z,N,O,y,H,S,r,i,ie]}class gs extends lt{constructor(e){super(),ot(this,e,_s,hs,nt,{height:5,width:6,itemCount:7,itemSize:8,estimatedItemSize:9,stickyIndices:10,getKey:0,scrollDirection:11,scrollOffset:12,scrollToIndex:13,scrollToAlignment:14,scrollToBehaviour:15,overscanCount:16,recomputeSizes:17},null,[-1,-1])}get height(){return this.$$.ctx[5]}set height(e){this.$$set({height:e}),Me()}get width(){return this.$$.ctx[6]}set width(e){this.$$set({width:e}),Me()}get itemCount(){return this.$$.ctx[7]}set itemCount(e){this.$$set({itemCount:e}),Me()}get itemSize(){return this.$$.ctx[8]}set itemSize(e){this.$$set({itemSize:e}),Me()}get estimatedItemSize(){return this.$$.ctx[9]}set estimatedItemSize(e){this.$$set({estimatedItemSize:e}),Me()}get stickyIndices(){return this.$$.ctx[10]}set stickyIndices(e){this.$$set({stickyIndices:e}),Me()}get getKey(){return this.$$.ctx[0]}set getKey(e){this.$$set({getKey:e}),Me()}get scrollDirection(){return this.$$.ctx[11]}set scrollDirection(e){this.$$set({scrollDirection:e}),Me()}get scrollOffset(){return this.$$.ctx[12]}set scrollOffset(e){this.$$set({scrollOffset:e}),Me()}get scrollToIndex(){return this.$$.ctx[13]}set scrollToIndex(e){this.$$set({scrollToIndex:e}),Me()}get scrollToAlignment(){return this.$$.ctx[14]}set scrollToAlignment(e){this.$$set({scrollToAlignment:e}),Me()}get scrollToBehaviour(){return this.$$.ctx[15]}set scrollToBehaviour(e){this.$$set({scrollToBehaviour:e}),Me()}get overscanCount(){return this.$$.ctx[16]}set overscanCount(e){this.$$set({overscanCount:e}),Me()}get recomputeSizes(){return this.$$.ctx[17]}}class Xt extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class Kn extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const ms="modulepreload",ps=function(t){return"https://will-moore.github.io/ome2024-ngff-challenge/"+t},Ci={},Dt=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(n.map(l=>{if(l=ps(l),l in Ci)return;Ci[l]=!0;const a=l.endsWith(".css"),h=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const f=document.createElement("link");if(f.rel=a?"stylesheet":ms,a||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),a)return new Promise((_,g)=>{f.addEventListener("load",_),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var qe;class wr{constructor(e,n,i){Ae(this,qe);typeof e=="number"?be(this,qe,new Uint8Array(e)):e instanceof ArrayBuffer?be(this,qe,new Uint8Array(e,n,i)):be(this,qe,new Uint8Array(Array.from(e,r=>r?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return K(this,qe).byteOffset}get byteLength(){return K(this,qe).byteLength}get buffer(){return K(this,qe).buffer}get length(){return K(this,qe).length}get(e){let n=K(this,qe)[e];return typeof n=="number"?n!==0:n}set(e,n){K(this,qe)[e]=n?1:0}fill(e){K(this,qe).fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}qe=new WeakMap;var Rt;class Jn{constructor(e,n,i,r){ee(this,"_data");ee(this,"chars");Ae(this,Rt);if(this.chars=e,be(this,Rt,new TextEncoder),typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)r&&(r=r*e),this._data=new Uint8Array(n,i,r);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(K(this,Rt).encode(n))}fill(e){const n=K(this,Rt).encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}Rt=new WeakMap;var Re;const $n=class $n{constructor(e,n,i,r){Ae(this,Re);ee(this,"chars");if(this.chars=e,typeof n=="number")be(this,Re,new Int32Array(n*e));else if(n instanceof ArrayBuffer)r&&(r*=e),be(this,Re,new Int32Array(n,i,r));else{const s=n,o=new $n(e,1);be(this,Re,new Int32Array(function*(){for(let l of s)o.set(0,l),yield*K(o,Re)}()))}}get BYTES_PER_ELEMENT(){return K(this,Re).BYTES_PER_ELEMENT*this.chars}get byteLength(){return K(this,Re).byteLength}get byteOffset(){return K(this,Re).byteOffset}get buffer(){return K(this,Re).buffer}get length(){return K(this,Re).length/this.chars}get(e){const n=this.chars*e;let i="";for(let r=0;r<this.chars;r++)i+=String.fromCodePoint(K(this,Re)[n+r]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,r=K(this,Re).subarray(i,i+this.chars);r.fill(0);for(let s=0;s<this.chars;s++)r[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=K(this,Re).subarray(0,this.chars);for(let i=1;i<this.length;i++)K(this,Re).set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}};Re=new WeakMap;let jt=$n;function $t(t){const e=new TextDecoder().decode(t);return JSON.parse(e)}function Ti(t,e){const n=e/2,i=e-1;let r=0;for(let s=0;s<t.length;s+=e)for(let o=0;o<n;o+=1)r=t[s+o],t[s+o]=t[s+i-o],t[s+i-o]=r}const ys={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float32:Float32Array,float64:Float64Array,bool:wr},bs=/v2:([US])(\d+)/;function kr(t){if(t==="v2:object")return globalThis.Array;let e=t.match(bs);if(e){let[,i,r]=e;return(i==="U"?jt:Jn).bind(null,Number(r))}let n=ys[t];if(!n)throw new Error(`Unknown or unsupported data_type: ${t}`);return n}function vt(t,e){return(e==="C"?vs:ws)(t)}function vs(t){const e=t.length,n=globalThis.Array(e);for(let i=e-1,r=1;i>=0;i--)n[i]=r,r*=t[i];return n}function ws(t){const e=t.length,n=globalThis.Array(e);for(let i=0,r=1;i<e;i++)n[i]=r,r*=t[i];return n}function ks({name:t,configuration:e}){if(t==="default"){const n=(e==null?void 0:e.separator)??"/";return i=>["c",...i].join(n)}if(t==="v2"){const n=(e==null?void 0:e.separator)??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function Fn(t){var n;const e=t.find(i=>i.name==="transpose");return((n=e==null?void 0:e.configuration)==null?void 0:n.order)==="F"?"F":"C"}const Es=/^([<|>])(.*)$/;function As(t){if(t==="|O")return{data_type:"v2:object"};let e=t.match(Es);if(!e)throw new Error(`Invalid dtype: ${t}`);let[,n,i]=e,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);if(!r)throw new Error(`Unsupported or unknown dtype: ${t}`);return n==="|"?{data_type:r}:{data_type:r,endian:n==="<"?"little":"big"}}function Ss(t,e={}){let n=[],i=As(t.dtype);t.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:r,...s}of t.filters??[])n.push({name:r,configuration:s});if(t.compressor){let{id:r,...s}=t.compressor;n.push({name:r,configuration:s})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function Is(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function Cs(t,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return t===e;let n=t==="bool";if(e==="boolean")return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if(e==="string")return i;let r=t==="int64"||t==="uint64";if(e==="bigint")return r;let s=t==="v2:object";return e==="object"?s:!i&&!r&&!n&&!s}function Ts(t){return(t==null?void 0:t.name)==="sharding_indexed"}function Er(t){return(t.data_type==="uint64"||t.data_type==="int64")&&t.fill_value!=null?BigInt(t.fill_value):t.fill_value}const zi=zs();function zs(){const t=new Uint32Array([305419896]);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0]!==18}function Ri(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}var qt,rt,xt,Vt,Ot;const ei=class ei{constructor(e,n){ee(this,"kind","array_to_bytes");Ae(this,qt);Ae(this,rt);Ae(this,xt);Ae(this,Vt);Ae(this,Ot);be(this,Ot,e==null?void 0:e.endian),be(this,rt,kr(n.data_type)),be(this,Vt,n.shape),be(this,qt,vt(n.shape,Fn(n.codecs)));const i=new(K(this,rt))(0);be(this,xt,i.BYTES_PER_ELEMENT)}static fromConfig(e,n){return new ei(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return zi&&K(this,Ot)==="big"&&Ti(n,Ri(K(this,rt))),n}decode(e){return zi&&K(this,Ot)==="big"&&Ti(e,Ri(K(this,rt))),{data:new(K(this,rt))(e.buffer,e.byteOffset,e.byteLength/K(this,xt)),shape:K(this,Vt),stride:K(this,qt)}}};qt=new WeakMap,rt=new WeakMap,xt=new WeakMap,Vt=new WeakMap,Ot=new WeakMap;let dn=ei;class Gn{constructor(){ee(this,"kind","bytes_to_bytes")}static fromConfig(){return new Gn}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}function Rs(t,e){if(Number.isNaN(e))throw new Error("JsonCodec allow_nan is false but NaN was encountered during encoding.");if(e===Number.POSITIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but Infinity was encountered during encoding.");if(e===Number.NEGATIVE_INFINITY)throw new Error("JsonCodec allow_nan is false but -Infinity was encountered during encoding.");return e}function Os(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}var Wt,Ht;const ti=class ti{constructor(e={}){ee(this,"configuration");ee(this,"kind","array_to_bytes");Ae(this,Wt);Ae(this,Ht);this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:r=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:a,strict:h=!0}=e;let f=e.separators;f||(a?f=[", ",": "]:f=[",",":"]),be(this,Wt,{encoding:n,skipkeys:i,ensure_ascii:r,check_circular:s,allow_nan:o,indent:a,separators:f,sort_keys:l}),be(this,Ht,{strict:h})}static fromConfig(e){return new ti(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:r,check_circular:s,allow_nan:o,sort_keys:l}=K(this,Wt);if(i!=="utf-8")throw new Error("JsonCodec does not yet support non-utf-8 encoding.");const a=[];if(!s)throw new Error("JsonCodec does not yet support skipping the check for circular references during encoding.");o||a.push(Rs),l&&a.push(Os);const h=Array.from(e.data);h.push("|O"),h.push(e.shape);let f;a.length&&(f=(g,b)=>{let m=b;for(let z of a)m=z(g,m);return m});let _=JSON.stringify(h,f,n);return r&&(_=_.replace(/[\u007F-\uFFFF]/g,g=>{const b=`0000${g.charCodeAt(0).toString(16)}`;return`\\u${b.substring(b.length-4)}`})),new TextEncoder().encode(_)}decode(e){const{strict:n}=K(this,Ht);if(!n)throw new Error("JsonCodec does not yet support non-strict decoding.");const i=$t(e),r=i.pop();if(i.pop(),!r)throw new Error("0D not implemented for JsonCodec.");const s=vt(r,"C");return{data:i,shape:r,stride:s}}};Wt=new WeakMap,Ht=new WeakMap;let Mn=ti;function Oi(t){return t instanceof wr||t instanceof Jn||t instanceof jt?new Proxy(t,{get(n,i){return n.get(Number(i))},set(n,i,r){return n.set(Number(i),r),!0}}):t}function Ls(t,e){let n;return t.data instanceof Jn||t.data instanceof jt?n=new t.constructor(t.data.length,t.data.chars):n=new t.constructor(t.data.length),{data:n,shape:t.shape,stride:vt(t.shape,e)}}function Fs(t,e){let n=Ls(t,e),i=t.shape.length,r=t.data.length,s=Array(i).fill(0),o=Oi(t.data),l=Oi(n.data);for(let a=0;a<r;a++){let h=0;for(let f=0;f<i;f++)h+=s[f]*n.stride[f];l[h]=o[a],s[0]+=1;for(let f=0;f<i;f++)if(s[f]===t.shape[f]){if(f+1===i)break;s[f]=0,s[f+1]+=1}}return n}function Ms(t){if(!t.stride)return"C";let e=vt(t.shape,"C");return t.stride.every((n,i)=>n===e[i])?"C":"F"}class Yn{constructor(e){ee(this,"configuration");ee(this,"kind","array_to_array");this.configuration=e}static fromConfig(e){return new Yn(e)}encode(e){var n,i;return Ms(e)===((n=this.configuration)==null?void 0:n.order)?e:Fs(e,((i=this.configuration)==null?void 0:i.order)??"C")}decode(e){return e}}var Kt,Jt;const ni=class ni{constructor(e){ee(this,"kind","array_to_bytes");Ae(this,Kt);Ae(this,Jt);be(this,Kt,e),be(this,Jt,vt(e,"C"))}static fromConfig(e,n){return new ni(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),r=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<r.length;o++){let l=i.getUint32(s,!0);s+=4,r[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:r,shape:K(this,Kt),stride:K(this,Jt)}}};Kt=new WeakMap,Jt=new WeakMap;let Dn=ni;function Ds(){return new Map().set("blosc",()=>Dt(()=>import("./blosc-E49GQuAK.js"),__vite__mapDeps([0,1])).then(t=>t.default)).set("gzip",()=>Dt(()=>import("./gzip-CF-9a_hd.js"),__vite__mapDeps([2,3])).then(t=>t.default)).set("lz4",()=>Dt(()=>import("./lz4-BIGKWw27.js"),__vite__mapDeps([4,1])).then(t=>t.default)).set("zlib",()=>Dt(()=>import("./zlib-CBiqHlio.js"),__vite__mapDeps([5,3])).then(t=>t.default)).set("zstd",()=>Dt(()=>import("./zstd-IvP746pw.js"),__vite__mapDeps([6,1])).then(t=>t.default)).set("transpose",()=>Yn).set("bytes",()=>dn).set("crc32c",()=>Gn).set("vlen-utf8",()=>Dn).set("json2",()=>Mn)}const Ns=Ds();function Nn(t){let e;return{async encode(n){e||(e=await Li(t));for(const r of e.array_to_array)n=await r.encode(n);let i=await e.array_to_bytes.encode(n);for(const r of e.bytes_to_bytes)i=await r.encode(i);return i},async decode(n){e||(e=await Li(t));for(let r=e.bytes_to_bytes.length-1;r>=0;r--)n=await e.bytes_to_bytes[r].decode(n);let i=await e.array_to_bytes.decode(n);for(let r=e.array_to_array.length-1;r>=0;r--)i=await e.array_to_array[r].decode(i);return i}}}async function Li(t){let e=t.codecs.map(async s=>{var l;let o=await((l=Ns.get(s.name))==null?void 0:l());if(!o)throw new Error(`Unknown codec: ${s.name}`);return{Codec:o,meta:s}}),n=[],i,r=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,t);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:r.push(l)}}if(!i){if(!Ps(t))throw new Error(`Cannot encode ${t.data_type} to bytes without a codec`);i=dn.fromConfig({endian:"little"},t)}return{array_to_array:n,array_to_bytes:i,bytes_to_bytes:r}}function Ps(t){return t.data_type!=="v2:object"}const Fi=18446744073709551615n;function Us(t,e,n,i){if(t.store.getRange===void 0)throw new Error("Store does not support range requests");let r=t.store.getRange.bind(t.store),s=e.map((a,h)=>a/i.chunk_shape[h]),o=Nn({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async a=>{let h=a.map((x,B)=>Math.floor(x/s[B])),f=t.resolve(n(h)).path,_;if(f in l)_=l[f];else{let x=4,B=16*s.reduce((q,Z)=>q*Z,1),H=await r(f,{suffixLength:B+x});_=l[f]=H?await o.decode(H):null}if(_===null)return;let{data:g,shape:b,stride:m}=_,z=a.map((x,B)=>x%b[B]).reduce((x,B,H)=>x+B*m[H],0),N=g[z],O=g[z+1];if(!(N===Fi&&O===Fi))return r(f,{offset:Number(N),length:Number(O)})}}class Lt{constructor(e,n="/"){ee(this,"store");ee(this,"path");this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new Lt(this.store,new URL(e,n).pathname)}}var Gt;class Qn extends Lt{constructor(n,i,r){super(n,i);ee(this,"kind","group");Ae(this,Gt);be(this,Gt,r)}get attrs(){return K(this,Gt).attributes}}Gt=new WeakMap;const Nt=Symbol("zarrita.context");function Bs(t){return t[Nt]}function js(t,e){let{configuration:n}=e.codecs.find(Ts)??{},i={encode_chunk_key:ks(e.chunk_key_encoding),TypedArray:kr(e.data_type),fill_value:e.fill_value};if(n){let s=Fn(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:Nn({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o,l){return vt(o,l??s)},get_chunk_bytes:Us(t,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let r=Fn(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:Nn({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s,o){return vt(s,o??r)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),a=t.resolve(l).path;return t.store.get(a,o)}}}var sr,or,bt,lr;let _n=(lr=class extends(or=Lt,sr=Nt,or){constructor(n,i,r){super(n,i);ee(this,"kind","array");Ae(this,bt);ee(this,sr);be(this,bt,{...r,fill_value:Er(r)}),this[Nt]=js(this,r)}get attrs(){return K(this,bt).attributes}get shape(){return K(this,bt).shape}get chunks(){return this[Nt].chunk_shape}get dtype(){return K(this,bt).data_type}async getChunk(n,i){let r=this[Nt],s=await r.get_chunk_bytes(n,i);if(!s){let o=r.chunk_shape.reduce((a,h)=>a*h,1),l=new r.TypedArray(o);return l.fill(r.fill_value),{data:l,shape:r.chunk_shape,stride:r.get_strides(r.chunk_shape)}}return r.codec.decode(s)}is(n){return Cs(this.dtype,n)}},bt=new WeakMap,lr),gn=qs();function qs(){let t=new WeakMap;function e(n){let i=t.get(n)??{v2:0,v3:0};return t.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function xs(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?$t(e):{}}async function Vs(t,e={}){let n="store"in t?t:new Lt(t),i={};return(e.attrs??!0)&&(i=await xs(n)),e.kind==="array"?Mi(n,i):e.kind==="group"?Di(n,i):Mi(n,i).catch(r=>{if(r instanceof Xt)return Di(n,i);throw r})}async function Mi(t,e){let{path:n}=t.resolve(".zarray"),i=await t.store.get(n);if(!i)throw new Xt("v2 array",{cause:new Kn(n)});return gn.increment(t.store,"v2"),new _n(t.store,t.path,Ss($t(i),e))}async function Di(t,e){let{path:n}=t.resolve(".zgroup"),i=await t.store.get(n);if(!i)throw new Xt("v2 group",{cause:new Kn(n)});return gn.increment(t.store,"v2"),new Qn(t.store,t.path,Is($t(i),e))}async function Ws(t){let{store:e,path:n}=t.resolve("zarr.json"),i=await t.store.get(n);if(!i)throw new Xt("v3 array or group",{cause:new Kn(n)});let r=$t(i);return r.node_type==="array"&&(r.fill_value=Er(r)),r.node_type==="array"?new _n(e,t.path,r):new Qn(e,t.path,r)}async function Hs(t,e={}){let n="store"in t?t:new Lt(t),i=await Ws(n);if(gn.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof _n||e.kind==="group"&&i instanceof Qn)return i;let r=i instanceof _n?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${r}.`)}async function yt(t,e={}){let n="store"in t?t.store:t,i=gn.version_max(n),r=i==="v2"?yt.v2:yt.v3,s=i==="v2"?yt.v3:yt.v2;return r(t,e).catch(o=>{if(o instanceof Xt)return s(t,e);throw o})}yt.v2=Vs;yt.v3=Hs;function*Ks(t,e,n=1){e===void 0&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*Js(...t){if(t.length===0)return;const e=t.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:r})=>r),i=0;n[i]=e[i].next()}}function Gs({start:t,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const r=n<0,[s,o]=r?[-1,i-1]:[0,i];return t===null?t=r?o:s:t<0?(t+=i,t<s&&(t=s)):t>o&&(t=o),e===null?e=r?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[t,e,n]}function Pn(t,e,n=null){return e===void 0&&(e=t,t=null),{start:t,stop:e,step:n}}function Ys(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}class Zn extends Error{constructor(e){super(e),this.name="IndexError"}}function Qs(t,e){throw new Zn(`too many indicies for array; expected ${e.length}, got ${t.length}`)}function Zs(t){throw new Zn(`index out of bounds for dimension with length ${t}`)}function Xs(){throw new Zn("only slices with step >= 1 are supported")}function $s(t,e){t.length>e.length&&Qs(t,e)}function eo(t,e){return t=Math.trunc(t),t<0&&(t=e+t),(t>=e||t<0)&&Zs(e),t}class to{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ee(this,"dim_sel");ee(this,"dim_len");ee(this,"dim_chunk_len");ee(this,"nitems");e=eo(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class Ni{constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){ee(this,"start");ee(this,"stop");ee(this,"step");ee(this,"dim_len");ee(this,"dim_chunk_len");ee(this,"nitems");ee(this,"nchunks");const[r,s,o]=Gs(e,n);this.start=r,this.stop=s,this.step=o,this.step<1&&Xs(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of Ks(e,n)){const r=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-r;let l=0,a=0;if(this.start<r){const b=(r-this.start)%this.step;b&&(a+=this.step-b),l=Math.ceil((r-this.start)/this.step)}else a=this.start-r;const h=this.stop>s?o:this.stop-r,f=[a,h,this.step],_=Math.ceil((h-a)/this.step),g=[l,l+_,1];yield{dim_chunk_ix:i,dim_chunk_sel:f,dim_out_sel:g}}}}function no(t,e){let n=[];return t===null?n=e.map(i=>Pn(null)):Array.isArray(t)&&(n=t.map(i=>i??Pn(null))),$s(n,e),n}class io{constructor({selection:e,shape:n,chunk_shape:i}){ee(this,"dim_indexers");ee(this,"shape");this.dim_indexers=no(e,n).map((r,s)=>new(typeof r=="number"?to:Ni)({dim_sel:r,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(r=>r instanceof Ni).map(r=>r.nitems)}*[Symbol.iterator](){for(const e of Js(...this.dim_indexers)){const n=e.map(r=>r.dim_chunk_ix),i=e.map(r=>"dim_out_sel"in r?{from:r.dim_chunk_sel,to:r.dim_out_sel}:{from:r.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function ro(t,e){return"get"in t?t.get(e):t[e]}async function so(t,e,n,i){var a;let r=Bs(t),s=new io({selection:e,shape:t.shape,chunk_shape:t.chunks}),o=i.prepare(new r.TypedArray(s.shape.reduce((h,f)=>h*f,1)),s.shape,r.get_strides(s.shape,n.order)),l=((a=n.create_queue)==null?void 0:a.call(n))??Ys();for(const{chunk_coords:h,mapping:f}of s)l.add(async()=>{let{data:_,shape:g,stride:b}=await t.getChunk(h,n.opts),m=i.prepare(_,g,b);i.set_from_chunk(o,m,f)});return await l.onIdle(),s.shape.length===0?ro(o.data,0):o}function Xn(t,e=0,n){let i=n??t.length-e;return{length:i,subarray(r,s=i){return Xn(t,e+r,s-r)},set(r,s=0){for(let o=0;o<r.length;o++)t[e+s+o]=r.get(o)},get(r){return t[e+r]}}}function Cn(t){return globalThis.Array.isArray(t.data)?{data:Xn(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}function oo(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}function lo(t,e){if(globalThis.Array.isArray(t.data))return Xn([e]);let n=oo(t.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const ao={prepare(t,e,n){return{data:t,shape:e,stride:n}},set_scalar(t,e,n){let i=Cn(t);Un(i,e,lo(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=Cn(t);un(i,Cn(e),i.bytes_per_element,n)}};async function uo(t,e=null,n={}){return so(t,e,n,ao)}function Ar(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function Un(t,e,n,i){if(e.length===0){t.data.set(n,0);return}const[r,...s]=e,[o,...l]=t.stride;if(typeof r=="number"){const g=t.data.subarray(o*r*i);Un({data:g,stride:l},s,n,i);return}const[a,h,f]=r,_=Ar(a,h,f);if(s.length===0){for(let g=0;g<_;g++)t.data.set(n,o*(a+f*g)*i);return}for(let g=0;g<_;g++){const b=t.data.subarray(o*(a+f*g)*i);Un({data:b,stride:l},s,n,i)}}function un(t,e,n,i){const[r,...s]=i,[o,...l]=t.stride,[a,...h]=e.stride;if(r.from===null){if(s.length===0){t.data.set(e.data.subarray(0,n),r.to*n);return}un({data:t.data.subarray(o*r.to*n),stride:l},e,n,s);return}if(r.to===null){if(s.length===0){let O=r.from*n;t.data.set(e.data.subarray(O,O+n),0);return}un(t,{data:e.data.subarray(a*r.from*n),stride:h},n,s);return}const[f,_,g]=r.to,[b,m,z]=r.from,N=Ar(f,_,g);if(s.length===0){if(g===1&&z===1&&o===1&&a===1){let O=b*n,x=N*n;t.data.set(e.data.subarray(O,O+x),f*n);return}for(let O=0;O<N;O++){let x=a*(b+z*O)*n;t.data.set(e.data.subarray(x,x+n),o*(f+g*O)*n)}return}for(let O=0;O<N;O++)un({data:t.data.subarray(o*(f+O*g)*n),stride:l},{data:e.data.subarray(a*(b+O*z)*n),stride:h},n,s)}function Sr(t,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function co(t,e){return{...t,...e,headers:{...t.headers,...e.headers}}}function Pi(t,e){const n=typeof t=="string"?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function Ui(t){if(!(t.status===404||t.status===403)){if(t.status===200||t.status===206)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}async function fo(t,e,n,i){if(i)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let s=r.headers.get("Content-Length"),o=Number(s);return Sr(t,o-e,o,n)}var Yt,Qt,Zt,Bn;class ho{constructor(e,n={}){Ae(this,Zt);ee(this,"url");Ae(this,Yt);Ae(this,Qt);this.url=e,be(this,Yt,n.overrides??{}),be(this,Qt,n.useSuffixRequest??!1)}async get(e,n={}){let i=Pi(this.url,e).href,r=await fetch(i,Sn(this,Zt,Bn).call(this,n));return Ui(r)}async getRange(e,n,i={}){let r=Pi(this.url,e),s=Sn(this,Zt,Bn).call(this,i),o;return"suffixLength"in n?o=await fo(r,n.suffixLength,s,K(this,Qt)):o=await Sr(r,n.offset,n.length,s),Ui(o)}}Yt=new WeakMap,Qt=new WeakMap,Zt=new WeakSet,Bn=function(e){return co(K(this,Yt),e)};function _o(t){let e,n;return{c(){e=A("div"),n=A("canvas"),ce(n,"width",t[3]+"px"),ce(n,"height",t[4]+"px"),ce(n,"background-color","lightgrey"),w(n,"height",t[2]),w(n,"width",t[1]),w(n,"class","svelte-lwhhyg"),w(e,"class","canvasWrapper svelte-lwhhyg"),ce(e,"width",t[3]+"px"),ce(e,"height",t[4]+"px"),Tt(e,"spinner",t[5])},m(i,r){pe(i,e,r),d(e,n),t[11](n)},p(i,[r]){r&8&&ce(n,"width",i[3]+"px"),r&16&&ce(n,"height",i[4]+"px"),r&4&&w(n,"height",i[2]),r&2&&w(n,"width",i[1]),r&8&&ce(e,"width",i[3]+"px"),r&16&&ce(e,"height",i[4]+"px"),r&32&&Tt(e,"spinner",i[5])},i:Te,o:Te,d(i){i&&_e(e),t[11](null)}}}const Bi=120;function go(t,e,n){let{source:i}=e,{attrs:r}=e,{thumbDatasetIndex:s=void 0}=e,{thumbAspectRatio:o=1}=e,{max_size:l=512}=e,a,h=120,f=120;o>1?f=h/o:o<1&&(h=f*o);let _=h,g=f,b=!0;const m=new AbortController;async function z(){var V;let O=r.multiscales[0].datasets.map(E=>E.path),x=r.multiscales[0].axes.map(E=>E.name),B=O.at(-1);s!=null&&s<O.length&&(B=O[s]);const H=new ho(i+"/"+B),q=await yt.v3(H,{kind:"array"});let Z=x.indexOf("c"),S=q.shape;if(S.at(-1)*S.at(-2)>l*l){console.log("Lowest resolution too large for Thumbnail: ",S,i);return}let u=S.length,c=S[Z]||1,p,I;(V=r==null?void 0:r.omero)!=null&&V.channels?(p=r.omero.channels.map(E=>E.active),I=r.omero.channels.map(E=>pr(E.color))):(p=ts(c),I=ns(c,p)),I=I.filter((E,ae)=>p[ae]);let L=p.reduce((E,ae,X)=>(ae&&E.push(X),E),[]).map(E=>{let ae=S.map((X,R)=>R==Z?E:R>=u-2?Pn(0,X):x[R]=="z"||x[R]=="t"?parseInt(X/2+""):0);return uo(q,ae,{opts:{signal:m.signal}})}),F=await Promise.all(L),M=F.map(E=>mr(E)),k=Xr(F,M,I);n(1,h=S.at(-1)),n(2,f=S.at(-2));let y=h/Bi;f>h&&(y=f/Bi),n(3,_=h/y),n(4,g=f/y),setTimeout(()=>{const E=a.getContext("2d");n(5,b=!1),E.putImageData(new ImageData(k,h,f),0,0)},100)}xn(()=>{z()}),Vn(()=>{m.abort()});function N(O){Bt[O?"unshift":"push"](()=>{a=O,n(0,a)})}return t.$$set=O=>{"source"in O&&n(6,i=O.source),"attrs"in O&&n(7,r=O.attrs),"thumbDatasetIndex"in O&&n(8,s=O.thumbDatasetIndex),"thumbAspectRatio"in O&&n(9,o=O.thumbAspectRatio),"max_size"in O&&n(10,l=O.max_size)},[a,h,f,_,g,b,i,r,s,o,l,N]}class mo extends lt{constructor(e){super(),ot(this,e,go,_o,nt,{source:6,attrs:7,thumbDatasetIndex:8,thumbAspectRatio:9,max_size:10})}}function ji(t,e,n){const i=t.slice();return i[9]=e[n],i}function qi(t){let e,n;return e=new mo({props:{source:t[3],attrs:t[2],max_size:2e3,thumbDatasetIndex:t[4],thumbAspectRatio:t[5]}}),{c(){Ke(e.$$.fragment)},m(i,r){xe(e,i,r),n=!0},p(i,r){const s={};r&8&&(s.source=i[3]),r&4&&(s.attrs=i[2]),r&16&&(s.thumbDatasetIndex=i[4]),r&32&&(s.thumbAspectRatio=i[5]),e.$set(s)},i(i){n||(he(e.$$.fragment,i),n=!0)},o(i){ve(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function xi(t){let e,n,i,r=t[0][`size_${t[9]}`]+"",s;return{c(){e=A("tr"),n=A("td"),n.textContent=`${t[9].toUpperCase()}`,i=A("td"),s=W(r),w(n,"class","svelte-11zzkuu"),w(i,"class","svelte-11zzkuu")},m(o,l){pe(o,e,l),d(e,n),d(e,i),d(i,s)},p(o,l){l&1&&r!==(r=o[0][`size_${o[9]}`]+"")&&Se(s,r)},d(o){o&&_e(e)}}}function Vi(t){let e,n=t[0][`size_${t[9]}`]!==void 0&&xi(t);return{c(){n&&n.c(),e=cr()},m(i,r){n&&n.m(i,r),pe(i,e,r)},p(i,r){i[0][`size_${i[9]}`]!==void 0?n?n.p(i,r):(n=xi(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){i&&_e(e),n&&n.d(i)}}}function Wi(t){var f;let e,n,i=t[0].source+"",r,s,o,l=((f=t[0].csv)==null?void 0:f.split("/").pop())+"",a,h;return{c(){e=A("div"),n=W("Data from "),r=W(i),s=W(`:
        `),o=A("a"),a=W(l),w(o,"href",h=Ki(t[0])),w(o,"target","_blank")},m(_,g){pe(_,e,g),d(e,n),d(e,r),d(e,s),d(e,o),d(o,a)},p(_,g){var b;g&1&&i!==(i=_[0].source+"")&&Se(r,i),g&1&&l!==(l=((b=_[0].csv)==null?void 0:b.split("/").pop())+"")&&Se(a,l),g&1&&h!==(h=Ki(_[0]))&&w(o,"href",h)},d(_){_&&_e(e)}}}function Hi(t){let e,n,i,r,s;return{c(){e=A("div"),n=A("a"),i=W("Original data"),w(n,"title",r="Link to original data: "+t[0].origin),w(n,"href",s=t[0].origin),w(n,"target","_blank")},m(o,l){pe(o,e,l),d(e,n),d(n,i)},p(o,l){l&1&&r!==(r="Link to original data: "+o[0].origin)&&w(n,"title",r),l&1&&s!==(s=o[0].origin)&&w(n,"href",s)},d(o){o&&_e(e)}}}function po(t){let e,n,i,r,s,o,l,a,h=fn(t[0].written)+"",f,_,g,b,m=(t[0].name?t[0].name.replaceAll(t[1],`<mark>${t[1]}</mark>`):"")+"",z,N,O=t[6].replaceAll(t[1],`<mark>${t[1]}</mark>`)+"",x,B,H,q,Z,S,u,c,p=t[2]&&qi(t),I=Je(["t","c","z","y","x"]),T=[];for(let M=0;M<5;M+=1)T[M]=Vi(ji(t,I,M));let L=t[0].source&&Wi(t),F=t[0].origin&&Hi(t);return{c(){e=A("div"),n=A("div"),p&&p.c(),i=Y(),r=A("table");for(let M=0;M<5;M+=1)T[M].c();s=Y(),o=A("tr"),l=A("td"),l.textContent="Size",a=A("td"),f=W(h),_=Y(),g=A("div"),b=A("div"),z=Y(),N=A("div"),x=Y(),L&&L.c(),B=Y(),F&&F.c(),H=Y(),q=A("a"),Z=W("OME-Validator"),w(n,"class","thumbWrapper svelte-11zzkuu"),w(l,"class","svelte-11zzkuu"),ce(a,"white-space","nowrap"),w(a,"class","svelte-11zzkuu"),w(r,"class","svelte-11zzkuu"),w(q,"title",S="Open in Validator: "+t[0].url),w(q,"href",u="https://deploy-preview-36--ome-ngff-validator.netlify.app/?source="+t[0].url),w(q,"target","_blank"),w(e,"class","zarr-list-item svelte-11zzkuu")},m(M,k){pe(M,e,k),d(e,n),p&&p.m(n,null),d(e,i),d(e,r);for(let y=0;y<5;y+=1)T[y]&&T[y].m(r,null);d(r,s),d(r,o),d(o,l),d(o,a),d(a,f),d(e,_),d(e,g),d(g,b),b.innerHTML=m,d(g,z),d(g,N),N.innerHTML=O,d(g,x),L&&L.m(g,null),d(g,B),F&&F.m(g,null),d(g,H),d(g,q),d(q,Z),c=!0},p(M,[k]){if(M[2]?p?(p.p(M,k),k&4&&he(p,1)):(p=qi(M),p.c(),he(p,1),p.m(n,null)):p&&(Wn(),ve(p,1,1,()=>{p=null}),Hn()),k&1){I=Je(["t","c","z","y","x"]);let y;for(y=0;y<5;y+=1){const V=ji(M,I,y);T[y]?T[y].p(V,k):(T[y]=Vi(V),T[y].c(),T[y].m(r,s))}for(;y<5;y+=1)T[y].d(1)}(!c||k&1)&&h!==(h=fn(M[0].written)+"")&&Se(f,h),(!c||k&3)&&m!==(m=(M[0].name?M[0].name.replaceAll(M[1],`<mark>${M[1]}</mark>`):"")+"")&&(b.innerHTML=m),(!c||k&66)&&O!==(O=M[6].replaceAll(M[1],`<mark>${M[1]}</mark>`)+"")&&(N.innerHTML=O),M[0].source?L?L.p(M,k):(L=Wi(M),L.c(),L.m(g,B)):L&&(L.d(1),L=null),M[0].origin?F?F.p(M,k):(F=Hi(M),F.c(),F.m(g,H)):F&&(F.d(1),F=null),(!c||k&1&&S!==(S="Open in Validator: "+M[0].url))&&w(q,"title",S),(!c||k&1&&u!==(u="https://deploy-preview-36--ome-ngff-validator.netlify.app/?source="+M[0].url))&&w(q,"href",u)},i(M){c||(he(p),c=!0)},o(M){ve(p),c=!1},d(M){M&&_e(e),p&&p.d(),cn(T,M),L&&L.d(),F&&F.d()}}}function Ki(t){return window.location.origin+window.location.pathname+"?csv="+t.csv}function yo(t,e,n){let i,{rowData:r}=e,{textFilter:s}=e,o,l,a,h=1;const f=new AbortController;if(r.size_x&&r.size_y){let _=Math.max(r.size_x,r.size_y);for(a=0;_>256;)a+=1,_=_/2;h=r.size_x/r.size_y}return xn(async()=>{let _=r.url;r.series0!==void 0&&(_+="/"+r.series0);let g=await hn(_,f.signal);n(2,o=g[0]),n(3,l=g[1]),g[2]}),Vn(()=>{f.abort()}),t.$$set=_=>{"rowData"in _&&n(0,r=_.rowData),"textFilter"in _&&n(1,s=_.textFilter)},t.$$.update=()=>{var _;t.$$.dirty&3&&n(6,i=s!=""&&((_=r.description)!=null&&_.includes(s))?r.description:"")},[r,s,o,l,a,h,i]}class bo extends lt{constructor(e){super(),ot(this,e,yo,po,nt,{rowData:0,textFilter:1})}}function vo(t){let e,n,i,r;return n=new bo({props:{rowData:t[0][t[12]],textFilter:t[1]}}),{c(){e=A("div"),Ke(n.$$.fragment),w(e,"slot","item"),w(e,"style",i=t[11]),w(e,"class","row svelte-1xvcjxw")},m(s,o){pe(s,e,o),xe(n,e,null),r=!0},p(s,o){const l={};o&4097&&(l.rowData=s[0][s[12]]),o&2&&(l.textFilter=s[1]),n.$set(l),(!r||o&2048&&i!==(i=s[11]))&&w(e,"style",i)},i(s){r||(he(n.$$.fragment,s),r=!0)},o(s){ve(n.$$.fragment,s),r=!1},d(s){s&&_e(e),Ve(n)}}}function wo(t){let e=!1,n=()=>{e=!1},i,r,s,o=`${t[4]}px`,l,a,h;return et(t[7]),et(t[8]),s=new gs({props:{width:"100%",height:t[4],itemCount:t[0].length,itemSize:160,getKey:t[5],$$slots:{item:[vo,({style:f,index:_})=>({11:f,12:_}),({style:f,index:_})=>(f?2048:0)|(_?4096:0)]},$$scope:{ctx:t}}}),s.$on("afterScroll",t[6]),{c(){r=A("div"),Ke(s.$$.fragment),w(r,"class","imageListContainer svelte-1xvcjxw"),ce(r,"height",o)},m(f,_){pe(f,r,_),xe(s,r,null),t[9](r),l=!0,a||(h=[we(window,"resize",t[7]),we(window,"scroll",()=>{e=!0,clearTimeout(i),i=setTimeout(n,100),t[8]()})],a=!0)},p(f,[_]){_&8&&!e&&(e=!0,clearTimeout(i),scrollTo(window.pageXOffset,f[3]),i=setTimeout(n,100));const g={};_&16&&(g.height=f[4]),_&1&&(g.itemCount=f[0].length),_&14339&&(g.$$scope={dirty:_,ctx:f}),s.$set(g),_&16&&o!==(o=`${f[4]}px`)&&ce(r,"height",o)},i(f){l||(he(s.$$.fragment,f),l=!0)},o(f){ve(s.$$.fragment,f),l=!1},d(f){f&&_e(r),Ve(s),t[9](null),a=!1,tt(h)}}}function ko(t,e,n){let i,{tableRows:r}=e,{textFilter:s}=e;function o(m){return r[m].url}let l,a=0,h=0;function f(m){let N=l.offsetTop-20;console.log("offsetTop",N,a),m.detail.offset-h<0&&a>N&&n(3,a-=1),h=m.detail.offset}function _(){n(4,i=window.innerHeight)}function g(){n(3,a=window.pageYOffset)}function b(m){Bt[m?"unshift":"push"](()=>{l=m,n(2,l)})}return t.$$set=m=>{"tableRows"in m&&n(0,r=m.tableRows),"textFilter"in m&&n(1,s=m.textFilter)},n(4,i=0),[r,s,l,a,i,o,f,_,g,b]}class Eo extends lt{constructor(e){super(),ot(this,e,ko,wo,nt,{tableRows:0,textFilter:1})}}const Ao="https://will-moore.github.io/ome2024-ngff-challenge/selectCaret.svg",So="https://will-moore.github.io/ome2024-ngff-challenge/ome-main-nav.svg";function Io(t){let e;return{c(){e=A("nav"),e.innerHTML=`<img style="height: 30px" alt="OME Logo" src="${So}"/> <h2 class="svelte-jcf7ka">2024 NGFF Challenge</h2> <ul class="svelte-jcf7ka"><li class="svelte-jcf7ka"><a href="https://github.com/ome/ome2024-ngff-challenge/" target="_blank" class="svelte-jcf7ka">About</a></li></ul>`,w(e,"class","svelte-jcf7ka")},m(n,i){pe(n,e,i)},p:Te,i:Te,o:Te,d(n){n&&_e(e)}}}class Co extends lt{constructor(e){super(),ot(this,e,null,Io,nt,{})}}function To(t){let e,n,i,r,s,o,l,a=t[0].source+"",h,f,_,g,b,m,z=t[0].total_count+"",N,O,x,B,H,q,Z;return{c(){e=A("div"),n=A("label"),i=A("img"),o=Y(),l=A("div"),h=W(a),f=Y(),_=A("br"),g=Y(),b=A("span"),m=W("("),N=W(z),O=W(" images)"),B=A("input"),w(i,"title",r=t[0].url),w(i,"class","sourceLogo svelte-wjxbqp"),w(i,"alt","Source logo"),gi(i.src,s=pi(t[0].source))||w(i,"src",s),w(b,"title",x=t[0].child_csv.length+" collections"),w(B,"type","radio"),w(B,"name","source"),B.value=H=t[0].source,w(B,"class","svelte-wjxbqp"),w(n,"class","svelte-wjxbqp"),w(e,"class","source svelte-wjxbqp")},m(S,u){pe(S,e,u),d(e,n),d(n,i),d(n,o),d(n,l),d(l,h),d(l,f),d(l,_),d(l,g),d(l,b),d(b,m),d(b,N),d(b,O),d(l,B),q||(Z=we(B,"change",function(){jn(t[1])&&t[1].apply(this,arguments)}),q=!0)},p(S,[u]){t=S,u&1&&r!==(r=t[0].url)&&w(i,"title",r),u&1&&!gi(i.src,s=pi(t[0].source))&&w(i,"src",s),u&1&&a!==(a=t[0].source+"")&&Se(h,a),u&1&&z!==(z=t[0].total_count+"")&&Se(N,z),u&1&&x!==(x=t[0].child_csv.length+" collections")&&w(b,"title",x),u&1&&H!==(H=t[0].source)&&(B.value=H)},i:Te,o:Te,d(S){S&&_e(e),q=!1,Z()}}}function zo(t,e,n){let{source:i}=e,{handleFilter:r}=e;return t.$$set=s=>{"source"in s&&n(0,i=s.source),"handleFilter"in s&&n(1,r=s.handleFilter)},[i,r]}class Ro extends lt{constructor(e){super(),ot(this,e,zo,To,nt,{source:0,handleFilter:1})}}function Ji(t,e,n){const i=t.slice();return i[30]=e[n],i}function Gi(t,e,n){const i=t.slice();return i[30]=e[n],i}function Yi(t,e,n){const i=t.slice();return i[35]=e[n],i}function Qi(t,e,n){const i=t.slice();return i[38]=e[n],i}function Zi(t){let e,n=t[1].length+"",i,r;return{c(){e=W(", from "),i=W(n),r=W(" sources")},m(s,o){pe(s,e,o),pe(s,i,o),pe(s,r,o)},p(s,o){o[0]&2&&n!==(n=s[1].length+"")&&Se(i,n)},d(s){s&&(_e(e),_e(i),_e(r))}}}function Xi(t){let e,n;return e=new Ro({props:{source:t[38],handleFilter:t[15]}}),{c(){Ke(e.$$.fragment)},m(i,r){xe(e,i,r),n=!0},p(i,r){const s={};r[0]&2&&(s.source=i[38]),e.$set(s)},i(i){n||(he(e.$$.fragment,i),n=!0)},o(i){ve(e.$$.fragment,i),n=!1},d(i){Ve(e,i)}}}function $i(t){let e,n,i,r,s,o;return{c(){e=A("div"),n=A("label"),i=A("input"),r=W(`
              ❌ Clear Source Filter`),w(i,"type","radio"),w(i,"name","source"),i.value="",w(i,"class","svelte-dx6cqk"),w(n,"class","svelte-dx6cqk"),w(e,"class","source clear svelte-dx6cqk")},m(l,a){pe(l,e,a),d(e,n),d(n,i),d(n,r),s||(o=we(i,"change",t[15]),s=!0)},p:Te,d(l){l&&_e(e),s=!1,o()}}}function er(t){let e,n,i,r,s,o,l,a,h,f=Je(De.getCsvSourceList(t[13])),_=[];for(let g=0;g<f.length;g+=1)_[g]=tr(Yi(t,f,g));return{c(){e=A("div"),n=A("select"),i=A("option"),i.textContent="Collection";for(let g=0;g<_.length;g+=1)_[g].c();r=Y(),s=A("div"),o=A("button"),l=W("×"),i.__value="",Oe(i,i.__value),w(n,"name","collection"),w(n,"class","svelte-dx6cqk"),t[11]===void 0&&et(()=>t[22].call(n)),w(o,"title","Clear Filter"),ce(o,"visibility",t[11]!==""?"visible":"hidden"),w(o,"class","svelte-dx6cqk"),w(s,"class","svelte-dx6cqk"),w(e,"class","selectWrapper svelte-dx6cqk")},m(g,b){pe(g,e,b),d(e,n),d(n,i);for(let m=0;m<_.length;m+=1)_[m]&&_[m].m(n,null);it(n,t[11],!0),d(e,r),d(e,s),d(s,o),d(o,l),a||(h=[we(n,"change",t[22]),we(n,"change",t[17]),we(o,"click",t[17])],a=!0)},p(g,b){if(b[0]&8192){f=Je(De.getCsvSourceList(g[13]));let m;for(m=0;m<f.length;m+=1){const z=Yi(g,f,m);_[m]?_[m].p(z,b):(_[m]=tr(z),_[m].c(),_[m].m(n,null))}for(;m<_.length;m+=1)_[m].d(1);_.length=f.length}b[0]&10240&&it(n,g[11]),b[0]&2048&&ce(o,"visibility",g[11]!==""?"visible":"hidden")},d(g){g&&_e(e),cn(_,g),a=!1,tt(h)}}}function tr(t){let e,n=(t[35].source==t[13]?rr(t[35].url):t[35].source)+"",i,r,s=t[35].image_count+"",o,l,a;return{c(){e=A("option"),i=W(n),r=W(" ("),o=W(s),l=W(`)
                  `),e.__value=a=t[35].url,Oe(e,e.__value)},m(h,f){pe(h,e,f),d(e,i),d(e,r),d(e,o),d(e,l)},p(h,f){f[0]&8192&&n!==(n=(h[35].source==h[13]?rr(h[35].url):h[35].source)+"")&&Se(i,n),f[0]&8192&&s!==(s=h[35].image_count+"")&&Se(o,s),f[0]&8192&&a!==(a=h[35].url)&&(e.__value=a,Oe(e,e.__value))},d(h){h&&_e(e)}}}function nr(t){let e,n=t[30]+"",i,r;return{c(){e=A("option"),i=W(n),e.__value=r=t[4][t[30]],Oe(e,e.__value)},m(s,o){pe(s,e,o),d(e,i)},p(s,o){o[0]&16&&n!==(n=s[30]+"")&&Se(i,n),o[0]&16&&r!==(r=s[4][s[30]])&&(e.__value=r,Oe(e,e.__value))},d(s){s&&_e(e)}}}function ir(t,e){let n,i=e[30]+"",r,s;return{key:t,first:null,c(){n=A("option"),r=W(i),n.__value=s=e[5][e[30]],Oe(n,n.__value),this.first=n},m(o,l){pe(o,n,l),d(n,r)},p(o,l){e=o,l[0]&32&&i!==(i=e[30]+"")&&Se(r,i),l[0]&32&&s!==(s=e[5][e[30]])&&(n.__value=s,Oe(n,n.__value))},d(o){o&&_e(n)}}}function Oo(t){let e,n,i,r,s,o,l,a,h=fn(t[3])+"",f,_,g,b,m,z,N,O,x,B,H,q,Z,S,u,c,p,I=t[13]!==""&&De.getCsvSourceList(t[13]).length>0,T,L,F,M,k=t[12]!==""?"All Dimensions":"Dimension Count",y,V,E,ae,X,R,ie,C,U,te,$,G,D,j,ne=t[10]==""?"Organism":"All Organisms",de,re,ke,ue,Q,Ne,Le,Ie,ge,Ee,se=t[9]==""?"Imaging Modality":"All Modalities",fe,Qe,J=[],Xe=new Map,We,He,Ce,Ge,Ye,ze,at,le,Ze,wt,ut,ii,ct,ri,ft,si,ht,oi,dt,li,kt,_t,ai,en=t[0].length+"",mn,ui,ci,gt,Pe,pn,fi;n=new Co({});let Ue=t[1].length>0&&Zi(t),mt=Je(t[1]),me=[];for(let v=0;v<mt.length;v+=1)me[v]=Xi(Qi(t,mt,v));const Ir=v=>ve(me[v],1,1,()=>{me[v]=null});let Be=t[13]!==""&&$i(t),je=I&&er(t),Et=Je(Object.keys(t[4]).sort()),Fe=[];for(let v=0;v<Et.length;v+=1)Fe[v]=nr(Gi(t,Et,v));let tn=Je(Object.keys(t[5]).sort());const hi=v=>v[30];for(let v=0;v<tn.length;v+=1){let P=Ji(t,tn,v),ye=hi(P);Xe.set(ye,J[v]=ir(ye,P))}return Ze=new It({props:{col_label:"X",col_name:"size_x",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),ut=new It({props:{col_label:"Y",col_name:"size_y",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),ct=new It({props:{col_label:"Z",col_name:"size_z",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),ft=new It({props:{col_label:"C",col_name:"size_c",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),ht=new It({props:{col_label:"T",col_name:"size_t",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),dt=new It({props:{col_label:"Data size",col_name:"written",handleSort:t[14],sortedBy:t[6],sortAscending:t[7]}}),gt=new Eo({props:{tableRows:t[0],textFilter:t[8]}}),{c(){e=A("div"),Ke(n.$$.fragment),i=Y(),r=A("main"),s=A("div"),o=A("h2"),l=W(t[2]),a=W(` Zarr Images,
        `),f=W(h),Ue&&Ue.c(),_=W(":"),g=Y(),b=A("div");for(let v=0;v<me.length;v+=1)me[v].c();m=Y(),Be&&Be.c(),z=Y(),N=A("div"),O=A("div"),x=A("div"),B=A("input"),H=Y(),q=A("button"),Z=W("×"),S=Y(),u=A("div"),c=A("div"),c.textContent="Filter by:",p=Y(),je&&je.c(),T=Y(),L=A("div"),F=A("select"),M=A("option"),y=W(k),V=A("hr"),E=A("option"),E.textContent="2D",ae=A("option"),ae.textContent="3D",X=A("option"),X.textContent="4D",R=A("option"),R.textContent="5D",ie=Y(),C=A("div"),U=A("button"),te=W("×"),$=Y(),G=A("div"),D=A("select"),j=A("option"),de=W(ne),re=A("hr");for(let v=0;v<Fe.length;v+=1)Fe[v].c();ke=Y(),ue=A("div"),Q=A("button"),Ne=W("×"),Le=Y(),Ie=A("div"),ge=A("select"),Ee=A("option"),fe=W(se),Qe=A("hr");for(let v=0;v<J.length;v+=1)J[v].c();We=Y(),He=A("div"),Ce=A("button"),Ge=W("×"),Ye=Y(),ze=A("div"),at=W(`
        Sort by:
        `),le=A("div"),Ke(Ze.$$.fragment),wt=Y(),Ke(ut.$$.fragment),ii=Y(),Ke(ct.$$.fragment),ri=Y(),Ke(ft.$$.fragment),si=Y(),Ke(ht.$$.fragment),oi=Y(),Ke(dt.$$.fragment),li=Y(),kt=A("div"),_t=A("h3"),ai=W("Showing "),mn=W(en),ui=W(" images"),ci=Y(),Ke(gt.$$.fragment),w(o,"class","svelte-dx6cqk"),w(b,"class","sources svelte-dx6cqk"),w(s,"class","summary svelte-dx6cqk"),w(B,"placeholder","Filter by Name or Description"),w(B,"name","textFilter"),w(B,"class","svelte-dx6cqk"),w(q,"title","Clear Filter"),ce(q,"visibility",t[8]!==""?"visible":"hidden"),w(q,"class","svelte-dx6cqk"),w(x,"class","textInputWrapper svelte-dx6cqk"),ce(c,"white-space","nowrap"),M.__value="",Oe(M,M.__value),E.__value="2",Oe(E,E.__value),ae.__value="3",Oe(ae,ae.__value),X.__value="4",Oe(X,X.__value),R.__value="5",Oe(R,R.__value),w(F,"class","svelte-dx6cqk"),t[12]===void 0&&et(()=>t[23].call(F)),w(U,"title","Clear Filter"),ce(U,"visibility",t[12]!==""?"visible":"hidden"),w(U,"class","svelte-dx6cqk"),w(C,"class","svelte-dx6cqk"),w(L,"class","selectWrapper svelte-dx6cqk"),j.__value="",Oe(j,j.__value),w(D,"class","svelte-dx6cqk"),t[10]===void 0&&et(()=>t[24].call(D)),w(Q,"title","Clear Filter"),ce(Q,"visibility",t[10]!==""?"visible":"hidden"),w(Q,"class","svelte-dx6cqk"),w(ue,"class","svelte-dx6cqk"),w(G,"class","selectWrapper svelte-dx6cqk"),Ee.__value="",Oe(Ee,Ee.__value),w(ge,"class","svelte-dx6cqk"),t[9]===void 0&&et(()=>t[25].call(ge)),w(Ce,"title","Clear Filter"),ce(Ce,"visibility",t[9]!==""?"visible":"hidden"),w(Ce,"class","svelte-dx6cqk"),w(He,"class","svelte-dx6cqk"),w(Ie,"class","selectWrapper svelte-dx6cqk"),w(ze,"class","clear svelte-dx6cqk"),w(u,"class","filters svelte-dx6cqk"),w(le,"class","sortButtons svelte-dx6cqk"),w(O,"class","sidebar svelte-dx6cqk"),ce(_t,"margin-left","15px"),w(_t,"class","svelte-dx6cqk"),w(kt,"class","results svelte-dx6cqk"),w(N,"class","sidebarContainer svelte-dx6cqk"),w(r,"class","svelte-dx6cqk"),w(e,"class","app svelte-dx6cqk"),ce(e,"--form-select-bg-img","url('"+Ao+"')")},m(v,P){pe(v,e,P),xe(n,e,null),d(e,i),d(e,r),d(r,s),d(s,o),d(o,l),d(o,a),d(o,f),Ue&&Ue.m(o,null),d(o,_),d(s,g),d(s,b);for(let ye=0;ye<me.length;ye+=1)me[ye]&&me[ye].m(b,null);d(b,m),Be&&Be.m(b,null),d(r,z),d(r,N),d(N,O),d(O,x),d(x,B),Oe(B,t[8]),d(x,H),d(x,q),d(q,Z),d(O,S),d(O,u),d(u,c),d(u,p),je&&je.m(u,null),d(u,T),d(u,L),d(L,F),d(F,M),d(M,y),d(F,V),d(F,E),d(F,ae),d(F,X),d(F,R),it(F,t[12],!0),d(L,ie),d(L,C),d(C,U),d(U,te),d(u,$),d(u,G),d(G,D),d(D,j),d(j,de),d(D,re);for(let ye=0;ye<Fe.length;ye+=1)Fe[ye]&&Fe[ye].m(D,null);it(D,t[10],!0),d(G,ke),d(G,ue),d(ue,Q),d(Q,Ne),d(u,Le),d(u,Ie),d(Ie,ge),d(ge,Ee),d(Ee,fe),d(ge,Qe);for(let ye=0;ye<J.length;ye+=1)J[ye]&&J[ye].m(ge,null);it(ge,t[9],!0),d(Ie,We),d(Ie,He),d(He,Ce),d(Ce,Ge),d(u,Ye),d(u,ze),d(O,at),d(O,le),xe(Ze,le,null),d(le,wt),xe(ut,le,null),d(le,ii),xe(ct,le,null),d(le,ri),xe(ft,le,null),d(le,si),xe(ht,le,null),d(le,oi),xe(dt,le,null),d(N,li),d(N,kt),d(kt,_t),d(_t,ai),d(_t,mn),d(_t,ui),d(kt,ci),xe(gt,kt,null),Pe=!0,pn||(fi=[we(B,"input",t[21]),we(B,"input",t[20]),we(q,"click",t[20]),we(F,"change",t[23]),we(F,"change",t[16]),we(U,"click",t[16]),we(D,"change",t[24]),we(D,"change",t[18]),we(Q,"click",t[18]),we(ge,"change",t[25]),we(ge,"change",t[19]),we(Ce,"click",t[19])],pn=!0)},p(v,P){if((!Pe||P[0]&4)&&Se(l,v[2]),(!Pe||P[0]&8)&&h!==(h=fn(v[3])+"")&&Se(f,h),v[1].length>0?Ue?Ue.p(v,P):(Ue=Zi(v),Ue.c(),Ue.m(o,_)):Ue&&(Ue.d(1),Ue=null),P[0]&32770){mt=Je(v[1]);let oe;for(oe=0;oe<mt.length;oe+=1){const Ft=Qi(v,mt,oe);me[oe]?(me[oe].p(Ft,P),he(me[oe],1)):(me[oe]=Xi(Ft),me[oe].c(),he(me[oe],1),me[oe].m(b,m))}for(Wn(),oe=mt.length;oe<me.length;oe+=1)Ir(oe);Hn()}if(v[13]!==""?Be?Be.p(v,P):(Be=$i(v),Be.c(),Be.m(b,null)):Be&&(Be.d(1),Be=null),P[0]&256&&B.value!==v[8]&&Oe(B,v[8]),(!Pe||P[0]&256)&&ce(q,"visibility",v[8]!==""?"visible":"hidden"),P[0]&8192&&(I=v[13]!==""&&De.getCsvSourceList(v[13]).length>0),I?je?je.p(v,P):(je=er(v),je.c(),je.m(u,T)):je&&(je.d(1),je=null),(!Pe||P[0]&4096)&&k!==(k=v[12]!==""?"All Dimensions":"Dimension Count")&&Se(y,k),P[0]&4096&&it(F,v[12]),(!Pe||P[0]&4096)&&ce(U,"visibility",v[12]!==""?"visible":"hidden"),(!Pe||P[0]&1024)&&ne!==(ne=v[10]==""?"Organism":"All Organisms")&&Se(de,ne),P[0]&16){Et=Je(Object.keys(v[4]).sort());let oe;for(oe=0;oe<Et.length;oe+=1){const Ft=Gi(v,Et,oe);Fe[oe]?Fe[oe].p(Ft,P):(Fe[oe]=nr(Ft),Fe[oe].c(),Fe[oe].m(D,null))}for(;oe<Fe.length;oe+=1)Fe[oe].d(1);Fe.length=Et.length}P[0]&1040&&it(D,v[10]),(!Pe||P[0]&1024)&&ce(Q,"visibility",v[10]!==""?"visible":"hidden"),(!Pe||P[0]&512)&&se!==(se=v[9]==""?"Imaging Modality":"All Modalities")&&Se(fe,se),P[0]&32&&(tn=Je(Object.keys(v[5]).sort()),J=fr(J,P,hi,1,v,tn,Xe,ge,Br,ir,null,Ji)),P[0]&544&&it(ge,v[9]),(!Pe||P[0]&512)&&ce(Ce,"visibility",v[9]!==""?"visible":"hidden");const ye={};P[0]&64&&(ye.sortedBy=v[6]),P[0]&128&&(ye.sortAscending=v[7]),Ze.$set(ye);const yn={};P[0]&64&&(yn.sortedBy=v[6]),P[0]&128&&(yn.sortAscending=v[7]),ut.$set(yn);const bn={};P[0]&64&&(bn.sortedBy=v[6]),P[0]&128&&(bn.sortAscending=v[7]),ct.$set(bn);const vn={};P[0]&64&&(vn.sortedBy=v[6]),P[0]&128&&(vn.sortAscending=v[7]),ft.$set(vn);const wn={};P[0]&64&&(wn.sortedBy=v[6]),P[0]&128&&(wn.sortAscending=v[7]),ht.$set(wn);const kn={};P[0]&64&&(kn.sortedBy=v[6]),P[0]&128&&(kn.sortAscending=v[7]),dt.$set(kn),(!Pe||P[0]&1)&&en!==(en=v[0].length+"")&&Se(mn,en);const En={};P[0]&1&&(En.tableRows=v[0]),P[0]&256&&(En.textFilter=v[8]),gt.$set(En)},i(v){if(!Pe){he(n.$$.fragment,v);for(let P=0;P<mt.length;P+=1)he(me[P]);he(Ze.$$.fragment,v),he(ut.$$.fragment,v),he(ct.$$.fragment,v),he(ft.$$.fragment,v),he(ht.$$.fragment,v),he(dt.$$.fragment,v),he(gt.$$.fragment,v),Pe=!0}},o(v){ve(n.$$.fragment,v),me=me.filter(Boolean);for(let P=0;P<me.length;P+=1)ve(me[P]);ve(Ze.$$.fragment,v),ve(ut.$$.fragment,v),ve(ct.$$.fragment,v),ve(ft.$$.fragment,v),ve(ht.$$.fragment,v),ve(dt.$$.fragment,v),ve(gt.$$.fragment,v),Pe=!1},d(v){v&&_e(e),Ve(n),Ue&&Ue.d(),cn(me,v),Be&&Be.d(),je&&je.d(),cn(Fe,v);for(let P=0;P<J.length;P+=1)J[P].d();Ve(Ze),Ve(ut),Ve(ct),Ve(ft),Ve(ht),Ve(dt),Ve(gt),pn=!1,tt(fi)}}}function rr(t){return t.split("/").pop().replace(".csv","").replace("_samples","")}function Lo(t,e,n){let i,r,s,o,l,a,f=new URLSearchParams(window.location.search).get("csv");try{new URL(f)}catch{f=Yr}let _=[],g=[],b=0,m=0,z={},N={};De.subscribe(k=>{n(0,_=H(k)),n(1,g=De.getCsvSourceList()),n(2,b=k.length),n(3,m=k.reduce((y,V)=>y+parseInt(V.written)||0,0))}),br.subscribe(k=>{let y={};for(const[V,E]of Object.entries(k))y[E]=V;n(4,z=y)}),vr.subscribe(k=>{let y={};for(const[V,E]of Object.entries(k))y[E]=V;n(5,N=y)}),f&&_r(f,De);let O="",x=!0;function B(k){O===k?n(7,x=!x):n(7,x=!1),n(6,O=k),De.sortTable(k,x)}function H(k){if(i!==""&&(k=k.filter(y=>y.dim_count==i)),s!=="")k=k.filter(y=>y.csv==s);else if(r!==""){let y=De.getCsvSourceList(r),V=[r,...y.map(E=>E.source)];k=k.filter(E=>V.includes(E.source))}return o!==""&&(k=k.filter(y=>y.organismId==o)),l!=""&&(k=k.filter(y=>y.fbbiId==l)),a!=""&&(k=k.filter(y=>{var V,E;return((V=y.description)==null?void 0:V.includes(a))||((E=y.name)==null?void 0:E.includes(a))})),k}function q(k){n(13,r=k.target.value||""),n(11,s=""),console.log("filterSource",r,s),n(0,_=H(De.getRows()))}function Z(k){n(12,i=k.target.value||""),n(0,_=H(De.getRows()))}function S(k){n(11,s=k.target.value||""),n(0,_=H(De.getRows()))}function u(k){n(10,o=k.target.value||""),n(0,_=H(De.getRows()))}function c(k){n(9,l=k.target.value||""),n(0,_=H(De.getRows()))}function p(k){n(8,a=k.target.value),n(0,_=H(De.getRows()))}function I(){a=this.value,n(8,a)}function T(){s=rn(this),n(11,s),n(13,r)}function L(){i=rn(this),n(12,i)}function F(){o=rn(this),n(10,o),n(4,z)}function M(){l=rn(this),n(9,l),n(5,N)}return t.$$.update=()=>{t.$$.dirty[0]&1&&_.some(k=>k.source)},n(12,i=""),n(13,r=""),n(11,s=""),n(10,o=""),n(9,l=""),n(8,a=""),[_,g,b,m,z,N,O,x,a,l,o,s,i,r,B,q,Z,S,u,c,p,I,T,L,F,M]}class Fo extends lt{constructor(e){super(),ot(this,e,Lo,Oo,nt,{},null,[-1,-1])}}new Fo({target:document.getElementById("app")});
